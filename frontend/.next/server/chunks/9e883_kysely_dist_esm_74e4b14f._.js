module.exports=[11874,e=>{"use strict";function t(e){return void 0===e||void 0===e}function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function s(e){return"boolean"==typeof e}function o(e){return null===e}function n(e){return e instanceof Date}function a(e){return"bigint"==typeof e}function d(e){return"u">typeof Buffer&&Buffer.isBuffer(e)}function p(e){return"function"==typeof e}function h(e){return"object"==typeof e&&null!==e}function u(e){return e[e.length-1]}function l(e){return Object.freeze(e)}function c(e){return N(e)?e:[e]}function N(e){return Array.isArray(e)}function f(e){return e}Object.prototype.toString,e.s(["asArray",()=>c,"freeze",()=>l,"getLast",()=>u,"isBigInt",()=>a,"isBoolean",()=>s,"isBuffer",()=>d,"isDate",()=>n,"isFunction",()=>p,"isNull",()=>o,"isNumber",()=>i,"isObject",()=>h,"isReadonlyArray",()=>N,"isString",()=>r,"isUndefined",()=>t,"noop",()=>f])},49216,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"IdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"IdentifierNode",name:e})});e.s(["IdentifierNode",0,r])},24356,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"CreateTableNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateTableNode",table:e,columns:(0,t.freeze)([])}),cloneWithColumn:(e,r)=>(0,t.freeze)({...e,columns:(0,t.freeze)([...e.columns,r])}),cloneWithConstraint:(e,r)=>(0,t.freeze)({...e,constraints:e.constraints?(0,t.freeze)([...e.constraints,r]):(0,t.freeze)([r])}),cloneWithFrontModifier:(e,r)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,r]):(0,t.freeze)([r])}),cloneWithEndModifier:(e,r)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,r]):(0,t.freeze)([r])}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["CreateTableNode",0,r,"ON_COMMIT_ACTIONS",0,["preserve rows","delete rows","drop"]])},71145,e=>{"use strict";var t=e.i(11874),r=e.i(49216);let i=(0,t.freeze)({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"SchemableIdentifierNode",identifier:r.IdentifierNode.create(e)}),createWithSchema:(e,i)=>(0,t.freeze)({kind:"SchemableIdentifierNode",schema:r.IdentifierNode.create(e),identifier:r.IdentifierNode.create(i)})});e.s(["SchemableIdentifierNode",0,i])},63422,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"AliasNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"AliasNode",node:e,alias:r})});e.s(["AliasNode",0,r])},14692,e=>{"use strict";var t=e.i(11874),r=e.i(71145);let i=(0,t.freeze)({is:e=>"TableNode"===e.kind,create:e=>(0,t.freeze)({kind:"TableNode",table:r.SchemableIdentifierNode.create(e)}),createWithSchema:(e,i)=>(0,t.freeze)({kind:"TableNode",table:r.SchemableIdentifierNode.createWithSchema(e,i)})});e.s(["TableNode",0,i])},67450,e=>{"use strict";var t=e.i(11874);function r(e){return(0,t.isObject)(e)&&(0,t.isFunction)(e.toOperationNode)}e.s(["isOperationNodeSource",()=>r])},62997,43531,e=>{"use strict";var t=e.i(67450),r=e.i(11874);function i(e){return(0,r.isObject)(e)&&"expressionType"in e&&(0,t.isOperationNodeSource)(e)}function s(e){return(0,r.isObject)(e)&&"expression"in e&&(0,r.isString)(e.alias)&&(0,t.isOperationNodeSource)(e)}e.s(["isAliasedExpression",()=>s,"isExpression",()=>i],62997);let o=(0,r.freeze)({is:e=>"SelectModifierNode"===e.kind,create:(e,t)=>(0,r.freeze)({kind:"SelectModifierNode",modifier:e,of:t}),createWithExpression:e=>(0,r.freeze)({kind:"SelectModifierNode",rawModifier:e})});e.s(["SelectModifierNode",0,o],43531)},82358,1695,10976,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"AndNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"AndNode",left:e,right:r})});e.s(["AndNode",0,r],1695);let i=(0,t.freeze)({is:e=>"OrNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"OrNode",left:e,right:r})});e.s(["OrNode",0,i],10976);let s=(0,t.freeze)({is:e=>"OnNode"===e.kind,create:e=>(0,t.freeze)({kind:"OnNode",on:e}),cloneWithOperation:(e,s,o)=>(0,t.freeze)({...e,on:"And"===s?r.create(e.on,o):i.create(e.on,o)})}),o=(0,t.freeze)({is:e=>"JoinNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:r,on:void 0}),createWithOn:(e,r,i)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:r,on:s.create(i)}),cloneWithOn:(e,r)=>(0,t.freeze)({...e,on:e.on?s.cloneWithOperation(e.on,"And",r):s.create(r)})});e.s(["JoinNode",0,o],82358)},46271,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"BinaryOperationNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"BinaryOperationNode",leftOperand:e,operator:r,rightOperand:i})});e.s(["BinaryOperationNode",0,r])},28008,e=>{"use strict";var t=e.i(11874);let r=["->","->>"],i=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...r,"not","-","exists","not exists","between","between symmetric"],s=(0,t.freeze)({is:e=>"OperatorNode"===e.kind,create:e=>(0,t.freeze)({kind:"OperatorNode",operator:e})});function o(e){return(0,t.isString)(e)&&r.includes(e)}e.s(["OPERATORS",0,i,"OperatorNode",0,s,"isJSONOperator",()=>o])},2563,63657,84167,e=>{"use strict";var t=e.i(11874),r=e.i(49216);let i=(0,t.freeze)({is:e=>"ColumnNode"===e.kind,create:e=>(0,t.freeze)({kind:"ColumnNode",column:r.IdentifierNode.create(e)})});e.s(["ColumnNode",0,i],2563);let s=(0,t.freeze)({is:e=>"SelectAllNode"===e.kind,create:()=>(0,t.freeze)({kind:"SelectAllNode"})});e.s(["SelectAllNode",0,s],63657);let o=(0,t.freeze)({is:e=>"ReferenceNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ReferenceNode",table:r,column:e}),createSelectAll:e=>(0,t.freeze)({kind:"ReferenceNode",table:e,column:s.create()})});e.s(["ReferenceNode",0,o],84167)},83514,21979,e=>{"use strict";e.s(["DynamicReferenceBuilder",()=>s,"isDynamicReferenceBuilder",()=>o],83514);var t=e.i(67450),r=e.i(54256),i=e.i(11874);class s{#e;get dynamicReference(){return this.#e}get refType(){}constructor(e){this.#e=e}toOperationNode(){return(0,r.parseSimpleReferenceExpression)(this.#e)}}function o(e){return(0,i.isObject)(e)&&(0,t.isOperationNodeSource)(e)&&(0,i.isString)(e.dynamicReference)}let n=(0,i.freeze)({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>(0,i.freeze)({kind:"OrderByItemNode",orderBy:e,direction:t}),cloneWith:(e,t)=>(0,i.freeze)({...e,...t})});e.s(["OrderByItemNode",0,n],21979)},18766,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"RawNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"RawNode",sqlFragments:(0,t.freeze)(e),parameters:(0,t.freeze)(r)}),createWithSql:e=>r.create([e],[]),createWithChild:e=>r.create(["",""],[e]),createWithChildren:e=>r.create(Array(e.length+1).fill(""),e)});e.s(["RawNode",0,r])},65925,e=>{"use strict";var t=e.i(11874),r=e.i(49216);let i=(0,t.freeze)({is:e=>"CollateNode"===e.kind,create:e=>(0,t.freeze)({kind:"CollateNode",collation:r.IdentifierNode.create(e)})});var s=e.i(21979),o=e.i(18766);class n{#t;constructor(e){this.#t=(0,t.freeze)(e)}desc(){return new n({node:s.OrderByItemNode.cloneWith(this.#t.node,{direction:o.RawNode.createWithSql("desc")})})}asc(){return new n({node:s.OrderByItemNode.cloneWith(this.#t.node,{direction:o.RawNode.createWithSql("asc")})})}nullsLast(){return new n({node:s.OrderByItemNode.cloneWith(this.#t.node,{nulls:"last"})})}nullsFirst(){return new n({node:s.OrderByItemNode.cloneWith(this.#t.node,{nulls:"first"})})}collate(e){return new n({node:s.OrderByItemNode.cloneWith(this.#t.node,{collation:i.create(e)})})}toOperationNode(){return this.#t.node}}e.s(["OrderByItemBuilder",()=>n],65925)},74988,e=>{"use strict";let t=new Set;function r(e){t.has(e)||(t.add(e),console.log(e))}e.s(["logOnce",()=>r])},30627,e=>{"use strict";e.s(["isOrderByDirection",()=>p,"parseOrderBy",()=>h]);var t=e.i(83514),r=e.i(62997),i=e.i(21979),s=e.i(18766),o=e.i(65925),n=e.i(74988),a=e.i(95031),d=e.i(54256);function p(e){return"asc"===e||"desc"===e}function h(e){if(2===e.length)return[u(e[0],e[1])];if(1===e.length){let[t]=e;return Array.isArray(t)?((0,n.logOnce)("orderBy(array) is deprecated, use multiple orderBy calls instead."),t.map(e=>u(e))):[u(t)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function u(e,r){let s=function(e){if((0,a.isExpressionOrFactory)(e))return(0,a.parseExpression)(e);if((0,t.isDynamicReferenceBuilder)(e))return e.toOperationNode();let[r,i]=e.split(" ");return i?((0,n.logOnce)("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),l((0,d.parseStringReference)(r),i)):(0,d.parseStringReference)(e)}(e);if(i.OrderByItemNode.is(s)){if(r)throw Error("Cannot specify direction twice!");return s}return l(s,r)}function l(e,t){if("string"==typeof t){if(!p(t))throw Error(`Invalid order by direction: ${t}`);return i.OrderByItemNode.create(e,s.RawNode.createWithSql(t))}if((0,r.isExpression)(t))return(0,n.logOnce)("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),i.OrderByItemNode.create(e,t.toOperationNode());let a=i.OrderByItemNode.create(e);return t?t(new o.OrderByItemBuilder({node:a})).toOperationNode():a}},73043,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"JSONReferenceNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JSONReferenceNode",reference:e,traversal:r}),cloneWithTraversal:(e,r)=>(0,t.freeze)({...e,traversal:r})});e.s(["JSONReferenceNode",0,r])},58450,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>(0,t.freeze)({kind:"JSONOperatorChainNode",operator:e,values:(0,t.freeze)([])}),cloneWithValue:(e,r)=>(0,t.freeze)({...e,values:(0,t.freeze)([...e.values,r])})});e.s(["JSONOperatorChainNode",0,r])},66590,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"JSONPathNode"===e.kind,create:e=>(0,t.freeze)({kind:"JSONPathNode",inOperator:e,pathLegs:(0,t.freeze)([])}),cloneWithLeg:(e,r)=>(0,t.freeze)({...e,pathLegs:(0,t.freeze)([...e.pathLegs,r])})});e.s(["JSONPathNode",0,r])},54256,e=>{"use strict";e.s(["parseAliasedStringReference",()=>v,"parseColumnName",()=>g,"parseJSONReference",()=>m,"parseOrderedColumnName",()=>w,"parseReferenceExpression",()=>f,"parseReferenceExpressionOrList",()=>N,"parseSimpleReferenceExpression",()=>c,"parseStringReference",()=>y]);var t=e.i(63422),r=e.i(2563),i=e.i(84167),s=e.i(14692),o=e.i(11874),n=e.i(95031),a=e.i(49216),d=e.i(30627),p=e.i(28008),h=e.i(73043),u=e.i(58450),l=e.i(66590);function c(e){return(0,o.isString)(e)?y(e):e.toOperationNode()}function N(e){return(0,o.isReadonlyArray)(e)?e.map(e=>f(e)):[f(e)]}function f(e){return(0,n.isExpressionOrFactory)(e)?(0,n.parseExpression)(e):c(e)}function m(e,t){let r=y(e);if((0,p.isJSONOperator)(t))return h.JSONReferenceNode.create(r,u.JSONOperatorChainNode.create(p.OperatorNode.create(t)));let i=t.slice(0,-1);if((0,p.isJSONOperator)(i))return h.JSONReferenceNode.create(r,l.JSONPathNode.create(p.OperatorNode.create(i)));throw Error(`Invalid JSON operator: ${t}`)}function y(e){if(!e.includes("."))return i.ReferenceNode.create(r.ColumnNode.create(e));let t=e.split(".").map(O);if(3===t.length)return function(e){let[t,o,n]=e;return i.ReferenceNode.create(r.ColumnNode.create(n),s.TableNode.createWithSchema(t,o))}(t);if(2===t.length)return function(e){let[t,o]=e;return i.ReferenceNode.create(r.ColumnNode.create(o),s.TableNode.create(t))}(t);throw Error(`invalid column reference ${e}`)}function v(e){let r=" as ";if(!e.includes(r))return y(e);{let[i,s]=e.split(r).map(O);return t.AliasNode.create(y(i),a.IdentifierNode.create(s))}}function g(e){return r.ColumnNode.create(e)}function w(e){if(!e.includes(" "))return g(e);{let[t,r]=e.split(" ").map(O);if(!(0,d.isOrderByDirection)(r))throw Error(`invalid order direction "${r}" next to "${t}"`);return(0,d.parseOrderBy)([t,r])[0]}}function O(e){return e.trim()}},11256,34978,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>(0,t.freeze)({kind:"PrimitiveValueListNode",values:(0,t.freeze)([...e])})});e.s(["PrimitiveValueListNode",0,r],11256);let i=(0,t.freeze)({is:e=>"ValueListNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValueListNode",values:(0,t.freeze)(e)})});e.s(["ValueListNode",0,i],34978)},89149,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"ValueNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValueNode",value:e}),createImmediate:e=>(0,t.freeze)({kind:"ValueNode",value:e,immediate:!0})});e.s(["ValueNode",0,r])},11176,e=>{"use strict";e.s(["isSafeImmediateValue",()=>d,"parseSafeImmediateValue",()=>p,"parseValueExpression",()=>a,"parseValueExpressionOrList",()=>n]);var t=e.i(11256),r=e.i(34978),i=e.i(89149),s=e.i(11874),o=e.i(95031);function n(e){var i;return(0,s.isReadonlyArray)(e)?(i=e).some(o.isExpressionOrFactory)?r.ValueListNode.create(i.map(e=>a(e))):t.PrimitiveValueListNode.create(i):a(e)}function a(e){return(0,o.isExpressionOrFactory)(e)?(0,o.parseExpression)(e):i.ValueNode.create(e)}function d(e){return(0,s.isNumber)(e)||(0,s.isBoolean)(e)||(0,s.isNull)(e)}function p(e){if(!d(e))throw Error(`unsafe immediate value ${JSON.stringify(e)}`);return i.ValueNode.createImmediate(e)}},80061,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"ParensNode"===e.kind,create:e=>(0,t.freeze)({kind:"ParensNode",node:e})});e.s(["ParensNode",0,r])},67545,64990,16835,65665,e=>{"use strict";e.s(["parseFilterList",()=>f,"parseFilterObject",()=>N,"parseReferentialBinaryOperation",()=>c,"parseValueBinaryOperation",()=>l,"parseValueBinaryOperationOrExpression",()=>u],67545);var t=e.i(46271),r=e.i(11874),i=e.i(67450),s=e.i(28008),o=e.i(54256),n=e.i(11176),a=e.i(89149),d=e.i(1695),p=e.i(80061),h=e.i(10976);function u(e){if(3===e.length)return l(e[0],e[1],e[2]);if(1===e.length)return(0,n.parseValueExpression)(e[0]);throw Error(`invalid arguments: ${JSON.stringify(e)}`)}function l(e,r,i){var s;return("is"===(s=r)||"is not"===s)&&m(i)?t.BinaryOperationNode.create((0,o.parseReferenceExpression)(e),y(r),a.ValueNode.createImmediate(i)):t.BinaryOperationNode.create((0,o.parseReferenceExpression)(e),y(r),(0,n.parseValueExpressionOrList)(i))}function c(e,r,i){return t.BinaryOperationNode.create((0,o.parseReferenceExpression)(e),y(r),(0,o.parseReferenceExpression)(i))}function N(e,t){return f(Object.entries(e).filter(([,e])=>!(0,r.isUndefined)(e)).map(([e,t])=>l(e,m(t)?"is":"=",t)),t)}function f(e,r,i=!0){let o="and"===r?d.AndNode.create:h.OrNode.create;if(0===e.length)return t.BinaryOperationNode.create(a.ValueNode.createImmediate(1),s.OperatorNode.create("="),a.ValueNode.createImmediate(+("and"===r)));let n=v(e[0]);for(let t=1;t<e.length;++t)n=o(n,v(e[t]));return e.length>1&&i?p.ParensNode.create(n):n}function m(e){return(0,r.isNull)(e)||(0,r.isBoolean)(e)}function y(e){if((0,r.isString)(e)&&s.OPERATORS.includes(e))return s.OperatorNode.create(e);if((0,i.isOperationNodeSource)(e))return e.toOperationNode();throw Error(`invalid operator ${JSON.stringify(e)}`)}function v(e){return(0,i.isOperationNodeSource)(e)?e.toOperationNode():e}let g=(0,r.freeze)({is:e=>"OrderByNode"===e.kind,create:e=>(0,r.freeze)({kind:"OrderByNode",items:(0,r.freeze)([...e])}),cloneWithItems:(e,t)=>(0,r.freeze)({...e,items:(0,r.freeze)([...e.items,...t])})});e.s(["OrderByNode",0,g],64990);let w=(0,r.freeze)({is:e=>"PartitionByNode"===e.kind,create:e=>(0,r.freeze)({kind:"PartitionByNode",items:(0,r.freeze)(e)}),cloneWithItems:(e,t)=>(0,r.freeze)({...e,items:(0,r.freeze)([...e.items,...t])})}),O=(0,r.freeze)({is:e=>"OverNode"===e.kind,create:()=>(0,r.freeze)({kind:"OverNode"}),cloneWithOrderByItems:(e,t)=>(0,r.freeze)({...e,orderBy:e.orderBy?g.cloneWithItems(e.orderBy,t):g.create(t)}),cloneWithPartitionByItems:(e,t)=>(0,r.freeze)({...e,partitionBy:e.partitionBy?w.cloneWithItems(e.partitionBy,t):w.create(t)})});e.s(["OverNode",0,O],16835),e.s(["JoinBuilder",()=>W],65665);var b=e.i(82358),x=e.i(18766);class W{#t;constructor(e){this.#t=(0,r.freeze)(e)}on(...e){return new W({...this.#t,joinNode:b.JoinNode.cloneWithOn(this.#t.joinNode,u(e))})}onRef(e,t,r){return new W({...this.#t,joinNode:b.JoinNode.cloneWithOn(this.#t.joinNode,c(e,t,r))})}onTrue(){return new W({...this.#t,joinNode:b.JoinNode.cloneWithOn(this.#t.joinNode,x.RawNode.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#t.joinNode}}},608,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"InsertQueryNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"InsertQueryNode",into:e,...r&&{with:r},replace:i}),createWithoutInto:()=>(0,t.freeze)({kind:"InsertQueryNode"}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["InsertQueryNode",0,r])},8134,75532,e=>{"use strict";e.s(["SelectQueryNode",()=>d],8134);var t=e.i(11874);let r=(0,t.freeze)({is:e=>"FromNode"===e.kind,create:e=>(0,t.freeze)({kind:"FromNode",froms:(0,t.freeze)(e)}),cloneWithFroms:(e,r)=>(0,t.freeze)({...e,froms:(0,t.freeze)([...e.froms,...r])})});e.s(["FromNode",0,r],75532);let i=(0,t.freeze)({is:e=>"GroupByNode"===e.kind,create:e=>(0,t.freeze)({kind:"GroupByNode",items:(0,t.freeze)(e)}),cloneWithItems:(e,r)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...r])})});var s=e.i(1695),o=e.i(10976);let n=(0,t.freeze)({is:e=>"HavingNode"===e.kind,create:e=>(0,t.freeze)({kind:"HavingNode",having:e}),cloneWithOperation:(e,r,i)=>(0,t.freeze)({...e,having:"And"===r?s.AndNode.create(e.having,i):o.OrNode.create(e.having,i)})});var a=e.i(22164);let d=(0,t.freeze)({is:e=>"SelectQueryNode"===e.kind,create:e=>(0,t.freeze)({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,i)=>(0,t.freeze)({kind:"SelectQueryNode",from:r.create(e),...i&&{with:i}}),cloneWithSelections:(e,r)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...r]):(0,t.freeze)(r)}),cloneWithDistinctOn:(e,r)=>(0,t.freeze)({...e,distinctOn:e.distinctOn?(0,t.freeze)([...e.distinctOn,...r]):(0,t.freeze)(r)}),cloneWithFrontModifier:(e,r)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,r]):(0,t.freeze)([r])}),cloneWithOrderByItems:(e,t)=>a.QueryNode.cloneWithOrderByItems(e,t),cloneWithGroupByItems:(e,r)=>(0,t.freeze)({...e,groupBy:e.groupBy?i.cloneWithItems(e.groupBy,r):i.create(r)}),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r}),cloneWithOffset:(e,r)=>(0,t.freeze)({...e,offset:r}),cloneWithFetch:(e,r)=>(0,t.freeze)({...e,fetch:r}),cloneWithHaving:(e,r)=>(0,t.freeze)({...e,having:e.having?n.cloneWithOperation(e.having,"And",r):n.create(r)}),cloneWithSetOperations:(e,r)=>(0,t.freeze)({...e,setOperations:e.setOperations?(0,t.freeze)([...e.setOperations,...r]):(0,t.freeze)([...r])}),cloneWithoutSelections:e=>(0,t.freeze)({...e,selections:[]}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithoutOffset:e=>(0,t.freeze)({...e,offset:void 0}),cloneWithoutOrderBy:e=>a.QueryNode.cloneWithoutOrderBy(e),cloneWithoutGroupBy:e=>(0,t.freeze)({...e,groupBy:void 0})})},27611,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"ListNode"===e.kind,create:e=>(0,t.freeze)({kind:"ListNode",items:(0,t.freeze)(e)})});e.s(["ListNode",0,r])},10262,e=>{"use strict";var t=e.i(11874),r=e.i(75532),i=e.i(27611);let s=(0,t.freeze)({is:e=>"UpdateQueryNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"UpdateQueryNode",table:1===e.length?e[0]:i.ListNode.create(e),...r&&{with:r}}),createWithoutTable:()=>(0,t.freeze)({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,i)=>(0,t.freeze)({...e,from:e.from?r.FromNode.cloneWithFroms(e.from,i):r.FromNode.create(i)}),cloneWithUpdates:(e,r)=>(0,t.freeze)({...e,updates:e.updates?(0,t.freeze)([...e.updates,...r]):r}),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r})});e.s(["UpdateQueryNode",0,s])},72315,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"UsingNode"===e.kind,create:e=>(0,t.freeze)({kind:"UsingNode",tables:(0,t.freeze)(e)}),cloneWithTables:(e,r)=>(0,t.freeze)({...e,tables:(0,t.freeze)([...e.tables,...r])})});e.s(["UsingNode",0,r])},19279,43165,86943,26244,e=>{"use strict";e.s(["DeleteQueryNode",()=>o],19279);var t=e.i(11874),r=e.i(75532),i=e.i(72315),s=e.i(22164);let o=(0,t.freeze)({is:e=>"DeleteQueryNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"DeleteQueryNode",from:r.FromNode.create(e),...i&&{with:i}}),cloneWithOrderByItems:(e,t)=>s.QueryNode.cloneWithOrderByItems(e,t),cloneWithoutOrderBy:e=>s.QueryNode.cloneWithoutOrderBy(e),cloneWithLimit:(e,r)=>(0,t.freeze)({...e,limit:r}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithUsing:(e,r)=>(0,t.freeze)({...e,using:void 0!==e.using?i.UsingNode.cloneWithTables(e.using,r):i.UsingNode.create(r)})});var n=e.i(1695),a=e.i(10976);let d=(0,t.freeze)({is:e=>"WhereNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhereNode",where:e}),cloneWithOperation:(e,r,i)=>(0,t.freeze)({...e,where:"And"===r?n.AndNode.create(e.where,i):a.OrNode.create(e.where,i)})});e.s(["WhereNode",0,d],43165);let p=(0,t.freeze)({is:e=>"ReturningNode"===e.kind,create:e=>(0,t.freeze)({kind:"ReturningNode",selections:(0,t.freeze)(e)}),cloneWithSelections:(e,r)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...r]):(0,t.freeze)(r)})});e.s(["ReturningNode",0,p],86943);let h=(0,t.freeze)({is:e=>"ExplainNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ExplainNode",format:e,options:r})});e.s(["ExplainNode",0,h],26244)},44625,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"WhenNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhenNode",condition:e}),cloneWithResult:(e,r)=>(0,t.freeze)({...e,result:r})});e.s(["WhenNode",0,r])},22164,41459,e=>{"use strict";e.s(["QueryNode",()=>c],22164);var t=e.i(608),r=e.i(8134),i=e.i(10262),s=e.i(19279),o=e.i(43165),n=e.i(11874),a=e.i(86943),d=e.i(26244),p=e.i(44625);let h=(0,n.freeze)({is:e=>"MergeQueryNode"===e.kind,create:(e,t)=>(0,n.freeze)({kind:"MergeQueryNode",into:e,...t&&{with:t}}),cloneWithUsing:(e,t)=>(0,n.freeze)({...e,using:t}),cloneWithWhen:(e,t)=>(0,n.freeze)({...e,whens:e.whens?(0,n.freeze)([...e.whens,t]):(0,n.freeze)([t])}),cloneWithThen:(e,t)=>(0,n.freeze)({...e,whens:e.whens?(0,n.freeze)([...e.whens.slice(0,-1),p.WhenNode.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})});e.s(["MergeQueryNode",0,h],41459);let u=(0,n.freeze)({is:e=>"OutputNode"===e.kind,create:e=>(0,n.freeze)({kind:"OutputNode",selections:(0,n.freeze)(e)}),cloneWithSelections:(e,t)=>(0,n.freeze)({...e,selections:e.selections?(0,n.freeze)([...e.selections,...t]):(0,n.freeze)(t)})});var l=e.i(64990);let c=(0,n.freeze)({is:e=>r.SelectQueryNode.is(e)||t.InsertQueryNode.is(e)||i.UpdateQueryNode.is(e)||s.DeleteQueryNode.is(e)||h.is(e),cloneWithEndModifier:(e,t)=>(0,n.freeze)({...e,endModifiers:e.endModifiers?(0,n.freeze)([...e.endModifiers,t]):(0,n.freeze)([t])}),cloneWithWhere:(e,t)=>(0,n.freeze)({...e,where:e.where?o.WhereNode.cloneWithOperation(e.where,"And",t):o.WhereNode.create(t)}),cloneWithJoin:(e,t)=>(0,n.freeze)({...e,joins:e.joins?(0,n.freeze)([...e.joins,t]):(0,n.freeze)([t])}),cloneWithReturning:(e,t)=>(0,n.freeze)({...e,returning:e.returning?a.ReturningNode.cloneWithSelections(e.returning,t):a.ReturningNode.create(t)}),cloneWithoutReturning:e=>(0,n.freeze)({...e,returning:void 0}),cloneWithoutWhere:e=>(0,n.freeze)({...e,where:void 0}),cloneWithExplain:(e,t,r)=>(0,n.freeze)({...e,explain:d.ExplainNode.create(t,r?.toOperationNode())}),cloneWithTop:(e,t)=>(0,n.freeze)({...e,top:t}),cloneWithOutput:(e,t)=>(0,n.freeze)({...e,output:e.output?u.cloneWithSelections(e.output,t):u.create(t)}),cloneWithOrderByItems:(e,t)=>(0,n.freeze)({...e,orderBy:e.orderBy?l.OrderByNode.cloneWithItems(e.orderBy,t):l.OrderByNode.create(t)}),cloneWithoutOrderBy:e=>(0,n.freeze)({...e,orderBy:void 0})})},46885,24270,e=>{"use strict";e.s(["OverBuilder",()=>a],46885);var t=e.i(16835),r=e.i(22164),i=e.i(30627),s=e.i(11874);let o=(0,s.freeze)({is:e=>"PartitionByItemNode"===e.kind,create:e=>(0,s.freeze)({kind:"PartitionByItemNode",partitionBy:e})});var n=e.i(54256);class a{#t;constructor(e){this.#t=(0,s.freeze)(e)}orderBy(...e){return new a({overNode:t.OverNode.cloneWithOrderByItems(this.#t.overNode,(0,i.parseOrderBy)(e))})}clearOrderBy(){return new a({overNode:r.QueryNode.cloneWithoutOrderBy(this.#t.overNode)})}partitionBy(e){return new a({overNode:t.OverNode.cloneWithPartitionByItems(this.#t.overNode,(0,n.parseReferenceExpressionOrList)(e).map(o.create))})}$call(e){return e(this)}toOperationNode(){return this.#t.overNode}}var d=e.i(84167),p=e.i(63657);let h=(0,s.freeze)({is:e=>"SelectionNode"===e.kind,create:e=>(0,s.freeze)({kind:"SelectionNode",selection:e}),createSelectAll:()=>(0,s.freeze)({kind:"SelectionNode",selection:p.SelectAllNode.create()}),createSelectAllFromTable:e=>(0,s.freeze)({kind:"SelectionNode",selection:d.ReferenceNode.createSelectAll(e)})});e.s(["SelectionNode",0,h],24270)},60986,79688,30766,40354,26581,54141,95317,16242,54222,22055,e=>{"use strict";e.s(["InsertQueryBuilder",()=>A],60986),e.s(["parseSelectAll",()=>h,"parseSelectArg",()=>d],79688);var t=e.i(11874),r=e.i(24270),i=e.i(54256),s=e.i(83514),o=e.i(95031),n=e.i(25466),a=e.i(89911);function d(e){return(0,t.isFunction)(e)?d(e((0,a.expressionBuilder)())):(0,t.isReadonlyArray)(e)?e.map(e=>p(e)):[p(e)]}function p(e){return(0,t.isString)(e)?r.SelectionNode.create((0,i.parseAliasedStringReference)(e)):(0,s.isDynamicReferenceBuilder)(e)?r.SelectionNode.create(e.toOperationNode()):r.SelectionNode.create((0,o.parseAliasedExpression)(e))}function h(e){return e?Array.isArray(e)?e.map(u):[u(e)]:[r.SelectionNode.createSelectAll()]}function u(e){if((0,t.isString)(e))return r.SelectionNode.createSelectAllFromTable((0,n.parseTable)(e));throw Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}e.s(["parseInsertExpression",()=>v],30766);var l=e.i(2563),c=e.i(11256),N=e.i(34978),f=e.i(11176);let m=(0,t.freeze)({is:e=>"ValuesNode"===e.kind,create:e=>(0,t.freeze)({kind:"ValuesNode",values:(0,t.freeze)(e)})}),y=(0,t.freeze)({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>(0,t.freeze)({kind:"DefaultInsertValueNode"})});function v(e){var r;let i,s=(0,t.isFunction)(e)?e((0,a.expressionBuilder)()):e;return i=function(e){let t=new Map;for(let r of e)for(let e of Object.keys(r))t.has(e)||void 0===r[e]||t.set(e,t.size);return t}(r=(0,t.isReadonlyArray)(s)?s:(0,t.freeze)([s])),[(0,t.freeze)([...i.keys()].map(l.ColumnNode.create)),m.create(r.map(e=>(function(e,r){let i=Object.keys(e),s=Array.from({length:r.size}),n=!1,a=i.length;for(let d of i){let i=r.get(d);if((0,t.isUndefined)(i)){a--;continue}let p=e[d];((0,t.isUndefined)(p)||(0,o.isExpressionOrFactory)(p))&&(n=!0),s[i]=p}if(a<r.size||n){let e=y.create();return N.ValueListNode.create(s.map(r=>(0,t.isUndefined)(r)?e:(0,f.parseValueExpression)(r)))}return c.PrimitiveValueListNode.create(s)})(e,i)))]}var g=e.i(608),w=e.i(22164);let O=(0,t.freeze)({is:e=>"ColumnUpdateNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"ColumnUpdateNode",column:e,value:r})});function b(e){return Object.entries((0,t.isFunction)(e)?e((0,a.expressionBuilder)()):e).filter(([e,t])=>void 0!==t).map(([e,t])=>O.create(l.ColumnNode.create(e),(0,f.parseValueExpression)(t)))}let x=(0,t.freeze)({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>(0,t.freeze)({kind:"OnDuplicateKeyNode",updates:e})});class W{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class S extends Error{node;constructor(e){super("no result"),this.node=e}}function z(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}e.s(["NoResultError",()=>S,"isNoResultErrorConstructor",()=>z],40354);var C=e.i(49216),I=e.i(43165);let q=(0,t.freeze)({is:e=>"OnConflictNode"===e.kind,create:()=>(0,t.freeze)({kind:"OnConflictNode"}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r}),cloneWithIndexWhere:(e,r)=>(0,t.freeze)({...e,indexWhere:e.indexWhere?I.WhereNode.cloneWithOperation(e.indexWhere,"And",r):I.WhereNode.create(r)}),cloneWithIndexOrWhere:(e,r)=>(0,t.freeze)({...e,indexWhere:e.indexWhere?I.WhereNode.cloneWithOperation(e.indexWhere,"Or",r):I.WhereNode.create(r)}),cloneWithUpdateWhere:(e,r)=>(0,t.freeze)({...e,updateWhere:e.updateWhere?I.WhereNode.cloneWithOperation(e.updateWhere,"And",r):I.WhereNode.create(r)}),cloneWithUpdateOrWhere:(e,r)=>(0,t.freeze)({...e,updateWhere:e.updateWhere?I.WhereNode.cloneWithOperation(e.updateWhere,"Or",r):I.WhereNode.create(r)}),cloneWithoutIndexWhere:e=>(0,t.freeze)({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>(0,t.freeze)({...e,updateWhere:void 0})});var k=e.i(67545);class B{#t;constructor(e){this.#t=(0,t.freeze)(e)}column(e){let r=l.ColumnNode.create(e);return new B({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?(0,t.freeze)([...this.#t.onConflictNode.columns,r]):(0,t.freeze)([r])})})}columns(e){let r=e.map(l.ColumnNode.create);return new B({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{columns:this.#t.onConflictNode.columns?(0,t.freeze)([...this.#t.onConflictNode.columns,...r]):(0,t.freeze)(r)})})}constraint(e){return new B({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{constraint:C.IdentifierNode.create(e)})})}expression(e){return new B({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new B({...this.#t,onConflictNode:q.cloneWithIndexWhere(this.#t.onConflictNode,(0,k.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,r){return new B({...this.#t,onConflictNode:q.cloneWithIndexWhere(this.#t.onConflictNode,(0,k.parseReferentialBinaryOperation)(e,t,r))})}clearWhere(){return new B({...this.#t,onConflictNode:q.cloneWithoutIndexWhere(this.#t.onConflictNode)})}doNothing(){return new E({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new T({...this.#t,onConflictNode:q.cloneWith(this.#t.onConflictNode,{updates:b(e)})})}$call(e){return e(this)}}class E{#t;constructor(e){this.#t=(0,t.freeze)(e)}toOperationNode(){return this.#t.onConflictNode}}class T{#t;constructor(e){this.#t=(0,t.freeze)(e)}where(...e){return new T({...this.#t,onConflictNode:q.cloneWithUpdateWhere(this.#t.onConflictNode,(0,k.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,r){return new T({...this.#t,onConflictNode:q.cloneWithUpdateWhere(this.#t.onConflictNode,(0,k.parseReferentialBinaryOperation)(e,t,r))})}clearWhere(){return new T({...this.#t,onConflictNode:q.cloneWithoutUpdateWhere(this.#t.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#t.onConflictNode}}let Q=(0,t.freeze)({is:e=>"TopNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"TopNode",expression:e,modifiers:r})});function R(e,r){var i;if(!(0,t.isNumber)(e)&&!(0,t.isBigInt)(e))throw Error(`Invalid top expression: ${e}`);if(!(0,t.isUndefined)(r)&&"percent"!==(i=r)&&"with ties"!==i&&"percent with ties"!==i)throw Error(`Invalid top modifiers: ${r}`);return Q.create(e,r)}e.s(["parseTop",()=>R],26581);let L=(0,t.freeze)({is:e=>"OrActionNode"===e.kind,create:e=>(0,t.freeze)({kind:"OrActionNode",action:e})});class A{#t;constructor(e){this.#t=(0,t.freeze)(e)}values(e){let[t,r]=v(e);return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{columns:t,values:r})})}columns(e){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{columns:(0,t.freeze)(e.map(l.ColumnNode.create))})})}expression(e){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{values:(0,o.parseExpression)(e)})})}defaultValues(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{defaultValues:!0})})}modifyEnd(e){return new A({...this.#t,queryNode:w.QueryNode.cloneWithEndModifier(this.#t.queryNode,e.toOperationNode())})}ignore(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("ignore")})})}orIgnore(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("ignore")})})}orAbort(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("abort")})})}orFail(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("fail")})})}orReplace(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("replace")})})}orRollback(){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{orAction:L.create("rollback")})})}top(e,t){return new A({...this.#t,queryNode:w.QueryNode.cloneWithTop(this.#t.queryNode,R(e,t))})}onConflict(e){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{onConflict:e(new B({onConflictNode:q.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new A({...this.#t,queryNode:g.InsertQueryNode.cloneWith(this.#t.queryNode,{onDuplicateKey:x.create(b(e))})})}returning(e){return new A({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,d(e))})}returningAll(){return new A({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,h())})}output(e){return new A({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,d(e))})}outputAll(e){return new A({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,h(e))})}clearReturning(){return new A({...this.#t,queryNode:w.QueryNode.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new A({...this.#t})}$castTo(){return new A(this.#t)}$narrowType(){return new A(this.#t)}$assertType(){return new A(this.#t)}withPlugin(e){return new A({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){let e=this.compile(),t=await this.#t.executor.executeQuery(e),{adapter:r}=this.#t.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new W(t.insertId,t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=S){let t=await this.executeTakeFirst();if(void 0===t)throw z(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#t.executor.stream(t,e))yield*r.rows}async explain(e,t){let r=new A({...this.#t,queryNode:w.QueryNode.cloneWithExplain(this.#t.queryNode,e,t)});return await r.execute()}}e.s(["DeleteQueryBuilder",()=>P],95317);var D=e.i(94387);class M{numDeletedRows;constructor(e){this.numDeletedRows=e}}var F=e.i(19279);let V=(0,t.freeze)({is:e=>"LimitNode"===e.kind,create:e=>(0,t.freeze)({kind:"LimitNode",limit:e})});e.s(["LimitNode",0,V],54141);var J=e.i(30627);class P{#t;constructor(e){this.#t=(0,t.freeze)(e)}where(...e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithWhere(this.#t.queryNode,(0,k.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,r){return new P({...this.#t,queryNode:w.QueryNode.cloneWithWhere(this.#t.queryNode,(0,k.parseReferentialBinaryOperation)(e,t,r))})}clearWhere(){return new P({...this.#t,queryNode:w.QueryNode.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new P({...this.#t,queryNode:w.QueryNode.cloneWithTop(this.#t.queryNode,R(e,t))})}using(e){return new P({...this.#t,queryNode:F.DeleteQueryNode.cloneWithUsing(this.#t.queryNode,(0,n.parseTableExpressionOrList)(e))})}innerJoin(...e){return this.#r("InnerJoin",e)}leftJoin(...e){return this.#r("LeftJoin",e)}rightJoin(...e){return this.#r("RightJoin",e)}fullJoin(...e){return this.#r("FullJoin",e)}#r(e,t){return new P({...this.#t,queryNode:w.QueryNode.cloneWithJoin(this.#t.queryNode,(0,D.parseJoin)(e,t))})}returning(e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,d(e))})}returningAll(e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,h(e))})}output(e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,d(e))})}outputAll(e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,h(e))})}clearReturning(){return new P({...this.#t,queryNode:w.QueryNode.cloneWithoutReturning(this.#t.queryNode)})}clearLimit(){return new P({...this.#t,queryNode:F.DeleteQueryNode.cloneWithoutLimit(this.#t.queryNode)})}orderBy(...e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithOrderByItems(this.#t.queryNode,(0,J.parseOrderBy)(e))})}clearOrderBy(){return new P({...this.#t,queryNode:w.QueryNode.cloneWithoutOrderBy(this.#t.queryNode)})}limit(e){return new P({...this.#t,queryNode:F.DeleteQueryNode.cloneWithLimit(this.#t.queryNode,V.create((0,f.parseValueExpression)(e)))})}modifyEnd(e){return new P({...this.#t,queryNode:w.QueryNode.cloneWithEndModifier(this.#t.queryNode,e.toOperationNode())})}$call(e){return e(this)}$if(e,t){return e?t(this):new P({...this.#t})}$castTo(){return new P(this.#t)}$narrowType(){return new P(this.#t)}$assertType(){return new P(this.#t)}withPlugin(e){return new P({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){let e=this.compile(),t=await this.#t.executor.executeQuery(e),{adapter:r}=this.#t.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new M(t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=S){let t=await this.executeTakeFirst();if(void 0===t)throw z(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#t.executor.stream(t,e))yield*r.rows}async explain(e,t){let r=new P({...this.#t,queryNode:w.QueryNode.cloneWithExplain(this.#t.queryNode,e,t)});return await r.execute()}}e.s(["UpdateQueryBuilder",()=>$],16242);var U=e.i(10262);class j{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class ${#t;constructor(e){this.#t=(0,t.freeze)(e)}where(...e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithWhere(this.#t.queryNode,(0,k.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,r){return new $({...this.#t,queryNode:w.QueryNode.cloneWithWhere(this.#t.queryNode,(0,k.parseReferentialBinaryOperation)(e,t,r))})}clearWhere(){return new $({...this.#t,queryNode:w.QueryNode.cloneWithoutWhere(this.#t.queryNode)})}top(e,t){return new $({...this.#t,queryNode:w.QueryNode.cloneWithTop(this.#t.queryNode,R(e,t))})}from(e){return new $({...this.#t,queryNode:U.UpdateQueryNode.cloneWithFromItems(this.#t.queryNode,(0,n.parseTableExpressionOrList)(e))})}innerJoin(...e){return this.#r("InnerJoin",e)}leftJoin(...e){return this.#r("LeftJoin",e)}rightJoin(...e){return this.#r("RightJoin",e)}fullJoin(...e){return this.#r("FullJoin",e)}#r(e,t){return new $({...this.#t,queryNode:w.QueryNode.cloneWithJoin(this.#t.queryNode,(0,D.parseJoin)(e,t))})}orderBy(...e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithOrderByItems(this.#t.queryNode,(0,J.parseOrderBy)(e))})}clearOrderBy(){return new $({...this.#t,queryNode:w.QueryNode.cloneWithoutOrderBy(this.#t.queryNode)})}limit(e){return new $({...this.#t,queryNode:U.UpdateQueryNode.cloneWithLimit(this.#t.queryNode,V.create((0,f.parseValueExpression)(e)))})}set(...e){return new $({...this.#t,queryNode:U.UpdateQueryNode.cloneWithUpdates(this.#t.queryNode,function(...e){return 2===e.length?[O.create((0,i.parseReferenceExpression)(e[0]),(0,f.parseValueExpression)(e[1]))]:b(e[0])}(...e))})}returning(e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,d(e))})}returningAll(e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithReturning(this.#t.queryNode,h(e))})}output(e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,d(e))})}outputAll(e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithOutput(this.#t.queryNode,h(e))})}modifyEnd(e){return new $({...this.#t,queryNode:w.QueryNode.cloneWithEndModifier(this.#t.queryNode,e.toOperationNode())})}clearReturning(){return new $({...this.#t,queryNode:w.QueryNode.cloneWithoutReturning(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new $({...this.#t})}$castTo(){return new $(this.#t)}$narrowType(){return new $(this.#t)}$assertType(){return new $(this.#t)}withPlugin(e){return new $({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){let e=this.compile(),t=await this.#t.executor.executeQuery(e),{adapter:r}=this.#t.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new j(t.numAffectedRows??BigInt(0),t.numChangedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=S){let t=await this.executeTakeFirst();if(void 0===t)throw z(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#t.executor.stream(t,e))yield*r.rows}async explain(e,t){let r=new $({...this.#t,queryNode:w.QueryNode.cloneWithExplain(this.#t.queryNode,e,t)});return await r.execute()}}e.s(["parseCommonTableExpression",()=>Y],54222);var K=e.i(14692);let G=(0,t.freeze)({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CommonTableExpressionNameNode",table:K.TableNode.create(e),columns:r?(0,t.freeze)(r.map(l.ColumnNode.create)):void 0})});var _=e.i(89358);let H=(0,t.freeze)({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"CommonTableExpressionNode",name:e,expression:r}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});class X{#t;constructor(e){this.#t=(0,t.freeze)(e)}materialized(){return new X({...this.#t,node:H.cloneWith(this.#t.node,{materialized:!0})})}notMaterialized(){return new X({...this.#t,node:H.cloneWith(this.#t.node,{materialized:!1})})}toOperationNode(){return this.#t.node}}function Y(e,r){var i;let s=r((0,_.createQueryCreator)()).toOperationNode();return(0,t.isFunction)(e)?e((i=s,e=>new X({node:H.create(Z(e),i)}))).toOperationNode():H.create(Z(e),s)}function Z(e){if(!e.includes("("))return G.create(e);{let t=e.split(/[\(\)]/),r=t[0],i=t[1].split(",").map(e=>e.trim());return G.create(r,i)}}let ee=(0,t.freeze)({is:e=>"WithNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"WithNode",expressions:(0,t.freeze)([e]),...r}),cloneWithExpression:(e,r)=>(0,t.freeze)({...e,expressions:(0,t.freeze)([...e.expressions,r])})});e.s(["WithNode",0,ee],22055)},20461,80173,e=>{"use strict";let t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function r(e){let r="";for(let i=0;i<e;++i)r+=t[~~(Math.random()*t.length)];return r}function i(){return new s}e.s(["randomString",()=>r],80173);class s{#i;get queryId(){return void 0===this.#i&&(this.#i=r(8)),this.#i}}e.s(["createQueryId",()=>i],20461)},52154,e=>{"use strict";var t=e.i(11874);class r{nodeStack=[];#s=(0,t.freeze)({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(e,r){if(!e)return e;this.nodeStack.push(e);let i=this.transformNodeImpl(e,r);return this.nodeStack.pop(),(0,t.freeze)(i)}transformNodeImpl(e,t){return this.#s[e.kind](e,t)}transformNodeList(e,r){return e?(0,t.freeze)(e.map(e=>this.transformNode(e,r))):e}transformSelectQuery(e,t){return{kind:"SelectQueryNode",from:this.transformNode(e.from,t),selections:this.transformNodeList(e.selections,t),distinctOn:this.transformNodeList(e.distinctOn,t),joins:this.transformNodeList(e.joins,t),groupBy:this.transformNode(e.groupBy,t),orderBy:this.transformNode(e.orderBy,t),where:this.transformNode(e.where,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),limit:this.transformNode(e.limit,t),offset:this.transformNode(e.offset,t),with:this.transformNode(e.with,t),having:this.transformNode(e.having,t),explain:this.transformNode(e.explain,t),setOperations:this.transformNodeList(e.setOperations,t),fetch:this.transformNode(e.fetch,t),top:this.transformNode(e.top,t)}}transformSelection(e,t){return{kind:"SelectionNode",selection:this.transformNode(e.selection,t)}}transformColumn(e,t){return{kind:"ColumnNode",column:this.transformNode(e.column,t)}}transformAlias(e,t){return{kind:"AliasNode",node:this.transformNode(e.node,t),alias:this.transformNode(e.alias,t)}}transformTable(e,t){return{kind:"TableNode",table:this.transformNode(e.table,t)}}transformFrom(e,t){return{kind:"FromNode",froms:this.transformNodeList(e.froms,t)}}transformReference(e,t){return{kind:"ReferenceNode",column:this.transformNode(e.column,t),table:this.transformNode(e.table,t)}}transformAnd(e,t){return{kind:"AndNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformOr(e,t){return{kind:"OrNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformValueList(e,t){return{kind:"ValueListNode",values:this.transformNodeList(e.values,t)}}transformParens(e,t){return{kind:"ParensNode",node:this.transformNode(e.node,t)}}transformJoin(e,t){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table,t),on:this.transformNode(e.on,t)}}transformRaw(e,r){return{kind:"RawNode",sqlFragments:(0,t.freeze)([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters,r)}}transformWhere(e,t){return{kind:"WhereNode",where:this.transformNode(e.where,t)}}transformInsertQuery(e,t){return{kind:"InsertQueryNode",into:this.transformNode(e.into,t),columns:this.transformNodeList(e.columns,t),values:this.transformNode(e.values,t),returning:this.transformNode(e.returning,t),onConflict:this.transformNode(e.onConflict,t),onDuplicateKey:this.transformNode(e.onDuplicateKey,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),ignore:e.ignore,orAction:this.transformNode(e.orAction,t),replace:e.replace,explain:this.transformNode(e.explain,t),defaultValues:e.defaultValues,top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformValues(e,t){return{kind:"ValuesNode",values:this.transformNodeList(e.values,t)}}transformDeleteQuery(e,t){return{kind:"DeleteQueryNode",from:this.transformNode(e.from,t),using:this.transformNode(e.using,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),orderBy:this.transformNode(e.orderBy,t),limit:this.transformNode(e.limit,t),explain:this.transformNode(e.explain,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformReturning(e,t){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections,t)}}transformCreateTable(e,t){return{kind:"CreateTableNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),constraints:this.transformNodeList(e.constraints,t),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),selectQuery:this.transformNode(e.selectQuery,t)}}transformColumnDefinition(e,t){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),references:this.transformNode(e.references,t),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo,t),check:this.transformNode(e.check,t),generated:this.transformNode(e.generated,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity,ifNotExists:e.ifNotExists}}transformAddColumn(e,t){return{kind:"AddColumnNode",column:this.transformNode(e.column,t)}}transformDropTable(e,t){return{kind:"DropTableNode",table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e,t){return{kind:"OrderByNode",items:this.transformNodeList(e.items,t)}}transformOrderByItem(e,t){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy,t),direction:this.transformNode(e.direction,t),collation:this.transformNode(e.collation,t),nulls:e.nulls}}transformGroupBy(e,t){return{kind:"GroupByNode",items:this.transformNodeList(e.items,t)}}transformGroupByItem(e,t){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy,t)}}transformUpdateQuery(e,t){return{kind:"UpdateQueryNode",table:this.transformNode(e.table,t),from:this.transformNode(e.from,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),updates:this.transformNodeList(e.updates,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),explain:this.transformNode(e.explain,t),limit:this.transformNode(e.limit,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t),orderBy:this.transformNode(e.orderBy,t)}}transformColumnUpdate(e,t){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column,t),value:this.transformNode(e.value,t)}}transformLimit(e,t){return{kind:"LimitNode",limit:this.transformNode(e.limit,t)}}transformOffset(e,t){return{kind:"OffsetNode",offset:this.transformNode(e.offset,t)}}transformOnConflict(e,t){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns,t),constraint:this.transformNode(e.constraint,t),indexExpression:this.transformNode(e.indexExpression,t),indexWhere:this.transformNode(e.indexWhere,t),updates:this.transformNodeList(e.updates,t),updateWhere:this.transformNode(e.updateWhere,t),doNothing:e.doNothing}}transformOnDuplicateKey(e,t){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates,t)}}transformCreateIndex(e,t){return{kind:"CreateIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists,where:this.transformNode(e.where,t),nullsNotDistinct:e.nullsNotDistinct}}transformList(e,t){return{kind:"ListNode",items:this.transformNodeList(e.items,t)}}transformDropIndex(e,t){return{kind:"DropIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e,t){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformUniqueConstraint(e,t){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),nullsNotDistinct:e.nullsNotDistinct,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformForeignKeyConstraint(e,t){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns,t),references:this.transformNode(e.references,t),name:this.transformNode(e.name,t),onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformSetOperation(e,t){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression,t),all:e.all}}transformReferences(e,t){return{kind:"ReferencesNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e,t){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression,t),name:this.transformNode(e.name,t)}}transformWith(e,t){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions,t),recursive:e.recursive}}transformCommonTableExpression(e,t){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name,t),materialized:e.materialized,expression:this.transformNode(e.expression,t)}}transformCommonTableExpressionName(e,t){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t)}}transformHaving(e,t){return{kind:"HavingNode",having:this.transformNode(e.having,t)}}transformCreateSchema(e,t){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema,t),ifNotExists:e.ifNotExists}}transformDropSchema(e,t){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema,t),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e,t){return{kind:"AlterTableNode",table:this.transformNode(e.table,t),renameTo:this.transformNode(e.renameTo,t),setSchema:this.transformNode(e.setSchema,t),columnAlterations:this.transformNodeList(e.columnAlterations,t),addConstraint:this.transformNode(e.addConstraint,t),dropConstraint:this.transformNode(e.dropConstraint,t),renameConstraint:this.transformNode(e.renameConstraint,t),addIndex:this.transformNode(e.addIndex,t),dropIndex:this.transformNode(e.dropIndex,t)}}transformDropColumn(e,t){return{kind:"DropColumnNode",column:this.transformNode(e.column,t)}}transformRenameColumn(e,t){return{kind:"RenameColumnNode",column:this.transformNode(e.column,t),renameTo:this.transformNode(e.renameTo,t)}}transformAlterColumn(e,t){return{kind:"AlterColumnNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),dataTypeExpression:this.transformNode(e.dataTypeExpression,t),setDefault:this.transformNode(e.setDefault,t),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e,t){return{kind:"ModifyColumnNode",column:this.transformNode(e.column,t)}}transformAddConstraint(e,t){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint,t)}}transformDropConstraint(e,t){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName,t),ifExists:e.ifExists,modifier:e.modifier}}transformRenameConstraint(e,t){return{kind:"RenameConstraintNode",oldName:this.transformNode(e.oldName,t),newName:this.transformNode(e.newName,t)}}transformCreateView(e,t){return{kind:"CreateViewNode",name:this.transformNode(e.name,t),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns,t),as:this.transformNode(e.as,t)}}transformRefreshMaterializedView(e,t){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(e.name,t),concurrently:e.concurrently,withNoData:e.withNoData}}transformDropView(e,t){return{kind:"DropViewNode",name:this.transformNode(e.name,t),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e,t){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression,t)}}transformDefaultValue(e,t){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue,t)}}transformOn(e,t){return{kind:"OnNode",on:this.transformNode(e.on,t)}}transformSelectModifier(e,t){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier,t),of:this.transformNodeList(e.of,t)}}transformCreateType(e,t){return{kind:"CreateTypeNode",name:this.transformNode(e.name,t),enum:this.transformNode(e.enum,t)}}transformDropType(e,t){return{kind:"DropTypeNode",name:this.transformNode(e.name,t),ifExists:e.ifExists}}transformExplain(e,t){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options,t)}}transformSchemableIdentifier(e,t){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema,t),identifier:this.transformNode(e.identifier,t)}}transformAggregateFunction(e,t){return{kind:"AggregateFunctionNode",func:e.func,aggregated:this.transformNodeList(e.aggregated,t),distinct:e.distinct,orderBy:this.transformNode(e.orderBy,t),withinGroup:this.transformNode(e.withinGroup,t),filter:this.transformNode(e.filter,t),over:this.transformNode(e.over,t)}}transformOver(e,t){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy,t),partitionBy:this.transformNode(e.partitionBy,t)}}transformPartitionBy(e,t){return{kind:"PartitionByNode",items:this.transformNodeList(e.items,t)}}transformPartitionByItem(e,t){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy,t)}}transformBinaryOperation(e,t){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand,t),operator:this.transformNode(e.operator,t),rightOperand:this.transformNode(e.rightOperand,t)}}transformUnaryOperation(e,t){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator,t),operand:this.transformNode(e.operand,t)}}transformUsing(e,t){return{kind:"UsingNode",tables:this.transformNodeList(e.tables,t)}}transformFunction(e,t){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments,t)}}transformCase(e,t){return{kind:"CaseNode",value:this.transformNode(e.value,t),when:this.transformNodeList(e.when,t),else:this.transformNode(e.else,t),isStatement:e.isStatement}}transformWhen(e,t){return{kind:"WhenNode",condition:this.transformNode(e.condition,t),result:this.transformNode(e.result,t)}}transformJSONReference(e,t){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference,t),traversal:this.transformNode(e.traversal,t)}}transformJSONPath(e,t){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator,t),pathLegs:this.transformNodeList(e.pathLegs,t)}}transformJSONPathLeg(e,t){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e,t){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator,t),values:this.transformNodeList(e.values,t)}}transformTuple(e,t){return{kind:"TupleNode",values:this.transformNodeList(e.values,t)}}transformMergeQuery(e,t){return{kind:"MergeQueryNode",into:this.transformNode(e.into,t),using:this.transformNode(e.using,t),whens:this.transformNodeList(e.whens,t),with:this.transformNode(e.with,t),top:this.transformNode(e.top,t),endModifiers:this.transformNodeList(e.endModifiers,t),output:this.transformNode(e.output,t),returning:this.transformNode(e.returning,t)}}transformMatched(e,t){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e,t){return{kind:"AddIndexNode",name:this.transformNode(e.name,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists}}transformCast(e,t){return{kind:"CastNode",expression:this.transformNode(e.expression,t),dataType:this.transformNode(e.dataType,t)}}transformFetch(e,t){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount,t),modifier:e.modifier}}transformTop(e,t){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformOutput(e,t){return{kind:"OutputNode",selections:this.transformNodeList(e.selections,t)}}transformDataType(e,t){return e}transformSelectAll(e,t){return e}transformIdentifier(e,t){return e}transformValue(e,t){return e}transformPrimitiveValueList(e,t){return e}transformOperator(e,t){return e}transformDefaultInsertValue(e,t){return e}transformOrAction(e,t){return e}transformCollate(e,t){return e}}e.s(["OperationNodeTransformer",()=>r],52154)},86870,e=>{"use strict";var t=e.i(63422),r=e.i(49216),i=e.i(82358),s=e.i(27611),o=e.i(52154),n=e.i(71145),a=e.i(14692),d=e.i(72315);let p=(0,e.i(11874).freeze)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),h={json_agg:!0,to_json:!0};class u extends o.OperationNodeTransformer{#o;#n=new Set;#a=new Set;constructor(e){super(),this.#o=e}transformNodeImpl(e,t){if(!this.#d(e))return super.transformNodeImpl(e,t);let r=this.#p(e);for(let e of r)this.#a.add(e);let i=this.#h(e);for(let e of i)this.#n.add(e);let s=super.transformNodeImpl(e,t);for(let e of i)this.#n.delete(e);for(let e of r)this.#a.delete(e);return s}transformSchemableIdentifier(e,t){let i=super.transformSchemableIdentifier(e,t);return i.schema||!this.#n.has(e.identifier.name)?i:{...i,schema:r.IdentifierNode.create(this.#o)}}transformReferences(e,t){let r=super.transformReferences(e,t);return r.table.table.schema?r:{...r,table:a.TableNode.createWithSchema(this.#o,r.table.table.identifier.name)}}transformAggregateFunction(e,t){return{...super.transformAggregateFunction({...e,aggregated:[]},t),aggregated:this.#u(e,t,"aggregated")}}transformFunction(e,t){return{...super.transformFunction({...e,arguments:[]},t),arguments:this.#u(e,t,"arguments")}}transformSelectModifier(e,t){return{...super.transformSelectModifier({...e,of:void 0},t),of:e.of?.map(e=>a.TableNode.is(e)&&!e.table.schema?{...e,table:this.transformIdentifier(e.table.identifier,t)}:this.transformNode(e,t))}}#u(e,t,r){return h[e.func]?e[r].map(e=>!a.TableNode.is(e)||e.table.schema?this.transformNode(e,t):{...e,table:this.transformIdentifier(e.table.identifier,t)}):this.transformNodeList(e[r],t)}#d(e){return e.kind in p}#h(e){let t=new Set;if("name"in e&&e.name&&n.SchemableIdentifierNode.is(e.name)&&this.#l(e.name,t),"from"in e&&e.from)for(let r of e.from.froms)this.#c(r,t);if("into"in e&&e.into&&this.#c(e.into,t),"table"in e&&e.table&&this.#c(e.table,t),"joins"in e&&e.joins)for(let r of e.joins)this.#c(r.table,t);return"using"in e&&e.using&&(i.JoinNode.is(e.using)?this.#c(e.using.table,t):this.#c(e.using,t)),t}#p(e){let t=new Set;return"with"in e&&e.with&&this.#N(e.with,t),t}#c(e,r){if(a.TableNode.is(e))return this.#l(e.table,r);if(t.AliasNode.is(e)&&a.TableNode.is(e.node))return this.#l(e.node.table,r);if(s.ListNode.is(e)){for(let t of e.items)this.#c(t,r);return}if(d.UsingNode.is(e)){for(let t of e.tables)this.#c(t,r);return}}#l(e,t){let r=e.identifier.name;this.#n.has(r)||this.#a.has(r)||t.add(r)}#N(e,t){for(let r of e.expressions){let e=r.name.table.table.identifier.name;this.#a.has(e)||t.add(e)}}}class l{#f;constructor(e){this.#f=new u(e)}transformQuery(e){return this.#f.transformNode(e.node,e.queryId)}async transformResult(e){return e.result}}e.s(["WithSchemaPlugin",()=>l],86870)},94387,32439,8120,522,85796,78710,89358,12276,99104,e=>{"use strict";e.s(["parseJoin",()=>G],94387);var t=e.i(82358),r=e.i(67545);e.s(["createJoinBuilder",()=>$,"createOverBuilder",()=>K,"createQueryCreator",()=>j],89358);var i=e.i(16835),s=e.i(65665),o=e.i(46885);e.s(["QueryCreator",()=>U],78710);var n=e.i(82096),a=e.i(60986),d=e.i(95317),p=e.i(16242),h=e.i(19279),u=e.i(608),l=e.i(8134),c=e.i(10262),N=e.i(25466),f=e.i(54222),m=e.i(22055),y=e.i(20461),v=e.i(86870),g=e.i(11874),w=e.i(79688),O=e.i(41459),b=e.i(22164),x=e.i(30766);let W=(0,g.freeze)({is:e=>"MatchedNode"===e.kind,create:(e,t=!1)=>(0,g.freeze)({kind:"MatchedNode",not:e,bySource:t})});var S=e.i(67450),z=e.i(18766),C=e.i(44625);function I(e,t,i){return C.WhenNode.create((0,r.parseFilterList)([W.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&i?(0,r.parseReferentialBinaryOperation)(t[0],t[1],t[2]):(0,r.parseValueBinaryOperationOrExpression)(t)]:[]],"and",!1))}function q(e){return(0,g.isString)(e)?z.RawNode.create([e],[]):(0,S.isOperationNodeSource)(e)?e.toOperationNode():e}var k=e.i(26581);class B{#m;#y;#v;constructor(){this.#m=new Promise((e,t)=>{this.#v=t,this.#y=e})}get promise(){return this.#m}resolve=e=>{this.#y&&this.#y(e)};reject=e=>{this.#v&&this.#v(e)}}async function E(e){let t=new B,r=new B;return e.provideConnection(async e=>(t.resolve(e),await r.promise)).catch(e=>t.reject(e)),(0,g.freeze)({connection:await t.promise,release:r.resolve})}e.s(["Deferred",()=>B],32439),e.s(["provideControlledConnection",()=>E],8120);var T=e.i(74988);let Q=(0,g.freeze)([]);class R{#g;constructor(e=Q){this.#g=e}get plugins(){return this.#g}transformQuery(e,t){for(let r of this.#g){let i=r.transformQuery({node:e,queryId:t});if(i.kind===e.kind)e=i;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${e.kind} but it returned a ${i.kind}`)}return e}async executeQuery(e){return await this.provideConnection(async t=>{let r=await t.executeQuery(e);return"numUpdatedOrDeletedRows"in r&&(0,T.logOnce)("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#w(r,e.queryId)})}async *stream(e,t){let{connection:r,release:i}=await E(this);try{for await(let i of r.streamQuery(e,t))yield await this.#w(i,e.queryId)}finally{i()}}async #w(e,t){for(let r of this.#g)e=await r.transformResult({result:e,queryId:t});return e}}e.s(["QueryExecutorBase",()=>R],522);class L extends R{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(e){return new L([...this.plugins,e])}withPlugins(e){return new L([...this.plugins,...e])}withPluginAtFront(e){return new L([e,...this.plugins])}withoutPlugins(){return new L([])}}let A=new L;e.s(["NOOP_QUERY_EXECUTOR",0,A],85796);class D{numChangedRows;constructor(e){this.numChangedRows=e}}var M=e.i(40354);class F{#t;constructor(e){this.#t=(0,g.freeze)(e)}modifyEnd(e){return new F({...this.#t,queryNode:b.QueryNode.cloneWithEndModifier(this.#t.queryNode,e.toOperationNode())})}top(e,t){return new F({...this.#t,queryNode:b.QueryNode.cloneWithTop(this.#t.queryNode,(0,k.parseTop)(e,t))})}using(...e){return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithUsing(this.#t.queryNode,G("Using",e))})}returning(e){return new F({...this.#t,queryNode:b.QueryNode.cloneWithReturning(this.#t.queryNode,(0,w.parseSelectArg)(e))})}returningAll(e){return new F({...this.#t,queryNode:b.QueryNode.cloneWithReturning(this.#t.queryNode,(0,w.parseSelectAll)(e))})}output(e){return new F({...this.#t,queryNode:b.QueryNode.cloneWithOutput(this.#t.queryNode,(0,w.parseSelectArg)(e))})}outputAll(e){return new F({...this.#t,queryNode:b.QueryNode.cloneWithOutput(this.#t.queryNode,(0,w.parseSelectAll)(e))})}}class V{#t;constructor(e){this.#t=(0,g.freeze)(e)}modifyEnd(e){return new V({...this.#t,queryNode:b.QueryNode.cloneWithEndModifier(this.#t.queryNode,e.toOperationNode())})}top(e,t){return new V({...this.#t,queryNode:b.QueryNode.cloneWithTop(this.#t.queryNode,(0,k.parseTop)(e,t))})}whenMatched(){return this.#O([])}whenMatchedAnd(...e){return this.#O(e)}whenMatchedAndRef(e,t,r){return this.#O([e,t,r],!0)}#O(e,t){return new J({...this.#t,queryNode:O.MergeQueryNode.cloneWithWhen(this.#t.queryNode,I({isMatched:!0},e,t))})}whenNotMatched(){return this.#b([])}whenNotMatchedAnd(...e){return this.#b(e)}whenNotMatchedAndRef(e,t,r){return this.#b([e,t,r],!0)}whenNotMatchedBySource(){return this.#b([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#b(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,r){return this.#b([e,t,r],!0,!0)}returning(e){return new V({...this.#t,queryNode:b.QueryNode.cloneWithReturning(this.#t.queryNode,(0,w.parseSelectArg)(e))})}returningAll(e){return new V({...this.#t,queryNode:b.QueryNode.cloneWithReturning(this.#t.queryNode,(0,w.parseSelectAll)(e))})}output(e){return new V({...this.#t,queryNode:b.QueryNode.cloneWithOutput(this.#t.queryNode,(0,w.parseSelectArg)(e))})}outputAll(e){return new V({...this.#t,queryNode:b.QueryNode.cloneWithOutput(this.#t.queryNode,(0,w.parseSelectAll)(e))})}#b(e,t=!1,r=!1){let i={...this.#t,queryNode:O.MergeQueryNode.cloneWithWhen(this.#t.queryNode,I({isMatched:!1,bySource:r},e,t))};return new(r?J:P)(i)}$call(e){return e(this)}$if(e,t){return e?t(this):new V({...this.#t})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){let e=this.compile(),t=await this.#t.executor.executeQuery(e),{adapter:r}=this.#t.executor,i=e.query;return i.returning&&r.supportsReturning||i.output&&r.supportsOutput?t.rows:[new D(t.numAffectedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=M.NoResultError){let t=await this.executeTakeFirst();if(void 0===t)throw(0,M.isNoResultErrorConstructor)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}}class J{#t;constructor(e){this.#t=(0,g.freeze)(e)}thenDelete(){return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithThen(this.#t.queryNode,q("delete"))})}thenDoNothing(){return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithThen(this.#t.queryNode,q("do nothing"))})}thenUpdate(e){return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithThen(this.#t.queryNode,q(e(new p.UpdateQueryBuilder({queryId:this.#t.queryId,executor:A,queryNode:c.UpdateQueryNode.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate(t=>t.set(...e))}}class P{#t;constructor(e){this.#t=(0,g.freeze)(e)}thenDoNothing(){return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithThen(this.#t.queryNode,q("do nothing"))})}thenInsertValues(e){let[t,r]=(0,x.parseInsertExpression)(e);return new V({...this.#t,queryNode:O.MergeQueryNode.cloneWithThen(this.#t.queryNode,q(u.InsertQueryNode.cloneWith(u.InsertQueryNode.createWithoutInto(),{columns:t,values:r})))})}}class U{#t;constructor(e){this.#t=(0,g.freeze)(e)}selectFrom(e){return(0,n.createSelectQueryBuilder)({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:l.SelectQueryNode.createFrom((0,N.parseTableExpressionOrList)(e),this.#t.withNode)})}selectNoFrom(e){return(0,n.createSelectQueryBuilder)({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:l.SelectQueryNode.cloneWithSelections(l.SelectQueryNode.create(this.#t.withNode),(0,w.parseSelectArg)(e))})}insertInto(e){return new a.InsertQueryBuilder({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:u.InsertQueryNode.create((0,N.parseTable)(e),this.#t.withNode)})}replaceInto(e){return new a.InsertQueryBuilder({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:u.InsertQueryNode.create((0,N.parseTable)(e),this.#t.withNode,!0)})}deleteFrom(e){return new d.DeleteQueryBuilder({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:h.DeleteQueryNode.create((0,N.parseTableExpressionOrList)(e),this.#t.withNode)})}updateTable(e){return new p.UpdateQueryBuilder({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:c.UpdateQueryNode.create((0,N.parseTableExpressionOrList)(e),this.#t.withNode)})}mergeInto(e){return new F({queryId:(0,y.createQueryId)(),executor:this.#t.executor,queryNode:O.MergeQueryNode.create((0,N.parseAliasedTable)(e),this.#t.withNode)})}with(e,t){let r=(0,f.parseCommonTableExpression)(e,t);return new U({...this.#t,withNode:this.#t.withNode?m.WithNode.cloneWithExpression(this.#t.withNode,r):m.WithNode.create(r)})}withRecursive(e,t){let r=(0,f.parseCommonTableExpression)(e,t);return new U({...this.#t,withNode:this.#t.withNode?m.WithNode.cloneWithExpression(this.#t.withNode,r):m.WithNode.create(r,{recursive:!0})})}withPlugin(e){return new U({...this.#t,executor:this.#t.executor.withPlugin(e)})}withoutPlugins(){return new U({...this.#t,executor:this.#t.executor.withoutPlugins()})}withSchema(e){return new U({...this.#t,executor:this.#t.executor.withPluginAtFront(new v.WithSchemaPlugin(e))})}}function j(){return new U({executor:A})}function $(e,r){return new s.JoinBuilder({joinNode:t.JoinNode.create(e,(0,N.parseTableExpression)(r))})}function K(){return new o.OverBuilder({overNode:i.OverNode.create()})}function G(e,i){var s,o,n,a,d,p,h,u;if(3===i.length){return s=e,o=i[0],n=i[1],a=i[2],t.JoinNode.createWithOn(s,(0,N.parseTableExpression)(o),(0,r.parseReferentialBinaryOperation)(n,"=",a))}if(2===i.length){return d=e,p=i[0],(0,i[1])($(d,p)).toOperationNode()}if(1===i.length){return h=e,u=i[0],t.JoinNode.create(h,(0,N.parseTableExpression)(u))}throw Error("not implemented")}let _=(0,g.freeze)({is:e=>"OffsetNode"===e.kind,create:e=>(0,g.freeze)({kind:"OffsetNode",offset:e})});e.s(["OffsetNode",0,_],12276),e.s(["parseGroupBy",()=>Z],99104);let H=(0,g.freeze)({is:e=>"GroupByItemNode"===e.kind,create:e=>(0,g.freeze)({kind:"GroupByItemNode",groupBy:e})});var X=e.i(89911),Y=e.i(54256);function Z(e){return e=(0,g.isFunction)(e)?e((0,X.expressionBuilder)()):e,(0,Y.parseReferenceExpressionOrList)(e).map(H.create)}},4038,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"SetOperationNode"===e.kind,create:(e,r,i)=>(0,t.freeze)({kind:"SetOperationNode",operator:e,expression:r,all:i})});e.s(["SetOperationNode",0,r])},82096,44431,39914,89332,58971,32150,e=>{"use strict";e.s(["createSelectQueryBuilder",()=>Q],82096);var t=e.i(63422),r=e.i(43531),i=e.i(94387),s=e.i(25466),o=e.i(79688),n=e.i(54256),a=e.i(8134),d=e.i(22164),p=e.i(30627),h=e.i(54141),u=e.i(12276),l=e.i(11874),c=e.i(99104),N=e.i(40354),f=e.i(49216),m=e.i(89911),y=e.i(4038),v=e.i(95031);function g(e,t,r){return(0,l.isFunction)(t)&&(t=t((0,m.createExpressionBuilder)())),(0,l.isReadonlyArray)(t)||(t=[t]),t.map(t=>y.SetOperationNode.create(e,(0,v.parseExpression)(t),r))}var w=e.i(67545);e.s(["ExpressionWrapper",()=>S],44431);var O=e.i(1695),b=e.i(67450),x=e.i(10976),W=e.i(80061);class S{#x;constructor(e){this.#x=e}get expressionType(){}as(e){return new z(this,e)}or(...e){return new C(x.OrNode.create(this.#x,(0,w.parseValueBinaryOperationOrExpression)(e)))}and(...e){return new I(O.AndNode.create(this.#x,(0,w.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new S(this.#x)}$notNull(){return new S(this.#x)}toOperationNode(){return this.#x}}class z{#W;#S;constructor(e,t){this.#W=e,this.#S=t}get expression(){return this.#W}get alias(){return this.#S}toOperationNode(){return t.AliasNode.create(this.#W.toOperationNode(),(0,b.isOperationNodeSource)(this.#S)?this.#S.toOperationNode():f.IdentifierNode.create(this.#S))}}class C{#x;constructor(e){this.#x=e}get expressionType(){}as(e){return new z(this,e)}or(...e){return new C(x.OrNode.create(this.#x,(0,w.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new C(this.#x)}toOperationNode(){return W.ParensNode.create(this.#x)}}class I{#x;constructor(e){this.#x=e}get expressionType(){}as(e){return new z(this,e)}and(...e){return new I(O.AndNode.create(this.#x,(0,w.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new I(this.#x)}toOperationNode(){return W.ParensNode.create(this.#x)}}var q=e.i(11176),k=e.i(89149);let B=(0,l.freeze)({is:e=>"FetchNode"===e.kind,create:(e,t)=>({kind:"FetchNode",rowCount:k.ValueNode.create(e),modifier:t})});var E=e.i(26581);class T{#t;constructor(e){this.#t=(0,l.freeze)(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithWhere(this.#t.queryNode,(0,w.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,r){return new T({...this.#t,queryNode:d.QueryNode.cloneWithWhere(this.#t.queryNode,(0,w.parseReferentialBinaryOperation)(e,t,r))})}having(...e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithHaving(this.#t.queryNode,(0,w.parseValueBinaryOperationOrExpression)(e))})}havingRef(e,t,r){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithHaving(this.#t.queryNode,(0,w.parseReferentialBinaryOperation)(e,t,r))})}select(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSelections(this.#t.queryNode,(0,o.parseSelectArg)(e))})}distinctOn(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithDistinctOn(this.#t.queryNode,(0,n.parseReferenceExpressionOrList)(e))})}modifyFront(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithFrontModifier(this.#t.queryNode,r.SelectModifierNode.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.createWithExpression(e.toOperationNode()))})}distinct(){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithFrontModifier(this.#t.queryNode,r.SelectModifierNode.create("Distinct"))})}forUpdate(e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("ForUpdate",e?(0,l.asArray)(e).map(s.parseTable):void 0))})}forShare(e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("ForShare",e?(0,l.asArray)(e).map(s.parseTable):void 0))})}forKeyShare(e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("ForKeyShare",e?(0,l.asArray)(e).map(s.parseTable):void 0))})}forNoKeyUpdate(e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("ForNoKeyUpdate",e?(0,l.asArray)(e).map(s.parseTable):void 0))})}skipLocked(){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("SkipLocked"))})}noWait(){return new T({...this.#t,queryNode:d.QueryNode.cloneWithEndModifier(this.#t.queryNode,r.SelectModifierNode.create("NoWait"))})}selectAll(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSelections(this.#t.queryNode,(0,o.parseSelectAll)(e))})}innerJoin(...e){return this.#r("InnerJoin",e)}leftJoin(...e){return this.#r("LeftJoin",e)}rightJoin(...e){return this.#r("RightJoin",e)}fullJoin(...e){return this.#r("FullJoin",e)}crossJoin(...e){return this.#r("CrossJoin",e)}innerJoinLateral(...e){return this.#r("LateralInnerJoin",e)}leftJoinLateral(...e){return this.#r("LateralLeftJoin",e)}crossJoinLateral(...e){return this.#r("LateralCrossJoin",e)}crossApply(...e){return this.#r("CrossApply",e)}outerApply(...e){return this.#r("OuterApply",e)}#r(e,t){return new T({...this.#t,queryNode:d.QueryNode.cloneWithJoin(this.#t.queryNode,(0,i.parseJoin)(e,t))})}orderBy(...e){return new T({...this.#t,queryNode:d.QueryNode.cloneWithOrderByItems(this.#t.queryNode,(0,p.parseOrderBy)(e))})}groupBy(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithGroupByItems(this.#t.queryNode,(0,c.parseGroupBy)(e))})}limit(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithLimit(this.#t.queryNode,h.LimitNode.create((0,q.parseValueExpression)(e)))})}offset(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithOffset(this.#t.queryNode,u.OffsetNode.create((0,q.parseValueExpression)(e)))})}fetch(e,t="only"){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithFetch(this.#t.queryNode,function(e,t){var r;if(!(0,l.isNumber)(e)&&!(0,l.isBigInt)(e))throw Error(`Invalid fetch row count: ${e}`);if("only"!==(r=t)&&"with ties"!==r)throw Error(`Invalid fetch modifier: ${t}`);return B.create(e,t)}(e,t))})}top(e,t){return new T({...this.#t,queryNode:d.QueryNode.cloneWithTop(this.#t.queryNode,(0,E.parseTop)(e,t))})}union(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("union",e,!1))})}unionAll(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("union",e,!0))})}intersect(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("intersect",e,!1))})}intersectAll(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("intersect",e,!0))})}except(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("except",e,!1))})}exceptAll(e){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithSetOperations(this.#t.queryNode,g("except",e,!0))})}as(e){return new R(this,e)}clearSelect(){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithoutSelections(this.#t.queryNode)})}clearWhere(){return new T({...this.#t,queryNode:d.QueryNode.cloneWithoutWhere(this.#t.queryNode)})}clearLimit(){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithoutLimit(this.#t.queryNode)})}clearOffset(){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithoutOffset(this.#t.queryNode)})}clearOrderBy(){return new T({...this.#t,queryNode:d.QueryNode.cloneWithoutOrderBy(this.#t.queryNode)})}clearGroupBy(){return new T({...this.#t,queryNode:a.SelectQueryNode.cloneWithoutGroupBy(this.#t.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new T({...this.#t})}$castTo(){return new T(this.#t)}$narrowType(){return new T(this.#t)}$assertType(){return new T(this.#t)}$asTuple(){return new S(this.toOperationNode())}$asScalar(){return new S(this.toOperationNode())}withPlugin(e){return new T({...this.#t,executor:this.#t.executor.withPlugin(e)})}toOperationNode(){return this.#t.executor.transformQuery(this.#t.queryNode,this.#t.queryId)}compile(){return this.#t.executor.compileQuery(this.toOperationNode(),this.#t.queryId)}async execute(){let e=this.compile();return(await this.#t.executor.executeQuery(e)).rows}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=N.NoResultError){let t=await this.executeTakeFirst();if(void 0===t)throw(0,N.isNoResultErrorConstructor)(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let r of this.#t.executor.stream(t,e))yield*r.rows}async explain(e,t){let r=new T({...this.#t,queryNode:d.QueryNode.cloneWithExplain(this.#t.queryNode,e,t)});return await r.execute()}}function Q(e){return new T(e)}class R{#z;#S;constructor(e,t){this.#z=e,this.#S=t}get expression(){return this.#z}get alias(){return this.#S}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return t.AliasNode.create(this.#z.toOperationNode(),f.IdentifierNode.create(this.#S))}}e.s(["createFunctionModule",()=>P],39914);var L=e.i(43165),A=e.i(64990);let D=(0,l.freeze)({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>(0,l.freeze)({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>(0,l.freeze)({...e,distinct:!0}),cloneWithOrderBy(e,t,r=!1){let i=r?"withinGroup":"orderBy";return(0,l.freeze)({...e,[i]:e[i]?A.OrderByNode.cloneWithItems(e[i],t):A.OrderByNode.create(t)})},cloneWithFilter:(e,t)=>(0,l.freeze)({...e,filter:e.filter?L.WhereNode.cloneWithOperation(e.filter,"And",t):L.WhereNode.create(t)}),cloneWithOrFilter:(e,t)=>(0,l.freeze)({...e,filter:e.filter?L.WhereNode.cloneWithOperation(e.filter,"Or",t):L.WhereNode.create(t)}),cloneWithOver:(e,t)=>(0,l.freeze)({...e,over:t})}),M=(0,l.freeze)({is:e=>"FunctionNode"===e.kind,create:(e,t)=>(0,l.freeze)({kind:"FunctionNode",func:e,arguments:t})});var F=e.i(89358);class V{#t;constructor(e){this.#t=(0,l.freeze)(e)}get expressionType(){}as(e){return new J(this,e)}distinct(){return new V({...this.#t,aggregateFunctionNode:D.cloneWithDistinct(this.#t.aggregateFunctionNode)})}orderBy(...e){return new V({...this.#t,aggregateFunctionNode:d.QueryNode.cloneWithOrderByItems(this.#t.aggregateFunctionNode,(0,p.parseOrderBy)(e))})}clearOrderBy(){return new V({...this.#t,aggregateFunctionNode:d.QueryNode.cloneWithoutOrderBy(this.#t.aggregateFunctionNode)})}withinGroupOrderBy(...e){return new V({...this.#t,aggregateFunctionNode:D.cloneWithOrderBy(this.#t.aggregateFunctionNode,(0,p.parseOrderBy)(e),!0)})}filterWhere(...e){return new V({...this.#t,aggregateFunctionNode:D.cloneWithFilter(this.#t.aggregateFunctionNode,(0,w.parseValueBinaryOperationOrExpression)(e))})}filterWhereRef(e,t,r){return new V({...this.#t,aggregateFunctionNode:D.cloneWithFilter(this.#t.aggregateFunctionNode,(0,w.parseReferentialBinaryOperation)(e,t,r))})}over(e){let t=(0,F.createOverBuilder)();return new V({...this.#t,aggregateFunctionNode:D.cloneWithOver(this.#t.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new V(this.#t)}$notNull(){return new V(this.#t)}toOperationNode(){return this.#t.aggregateFunctionNode}}class J{#C;#S;constructor(e,t){this.#C=e,this.#S=t}get expression(){return this.#C}get alias(){return this.#S}toOperationNode(){return t.AliasNode.create(this.#C.toOperationNode(),f.IdentifierNode.create(this.#S))}}function P(){let e=(e,t)=>new S(M.create(e,(0,n.parseReferenceExpressionOrList)(t??[]))),t=(e,t)=>new V({aggregateFunctionNode:D.create(e,t?(0,n.parseReferenceExpressionOrList)(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>t("count",[e]),countAll:e=>new V({aggregateFunctionNode:D.create("count",(0,o.parseSelectAll)(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new V({aggregateFunctionNode:D.create("json_agg",[(0,l.isString)(e)?(0,s.parseTable)(e):e.toOperationNode()])}),toJson:e=>new S(M.create("to_json",[(0,l.isString)(e)?(0,s.parseTable)(e):e.toOperationNode()]))})}e.s(["parseUnaryOperation",()=>$],89332);var U=e.i(28008);let j=(0,l.freeze)({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>(0,l.freeze)({kind:"UnaryOperationNode",operator:e,operand:t})});function $(e,t){return j.create(U.OperatorNode.create(e),(0,n.parseReferenceExpression)(t))}e.s(["CaseBuilder",()=>_],32150);var K=e.i(44625);let G=(0,l.freeze)({is:e=>"CaseNode"===e.kind,create:e=>(0,l.freeze)({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>(0,l.freeze)({...e,when:(0,l.freeze)(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>(0,l.freeze)({...e,when:e.when?(0,l.freeze)([...e.when.slice(0,-1),K.WhenNode.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>(0,l.freeze)({...e,...t})});e.s(["CaseNode",0,G],58971);class _{#t;constructor(e){this.#t=(0,l.freeze)(e)}when(...e){return new H({...this.#t,node:G.cloneWithWhen(this.#t.node,K.WhenNode.create((0,w.parseValueBinaryOperationOrExpression)(e)))})}}class H{#t;constructor(e){this.#t=(0,l.freeze)(e)}then(e){return new X({...this.#t,node:G.cloneWithThen(this.#t.node,(0,q.isSafeImmediateValue)(e)?(0,q.parseSafeImmediateValue)(e):(0,q.parseValueExpression)(e))})}}class X{#t;constructor(e){this.#t=(0,l.freeze)(e)}when(...e){return new H({...this.#t,node:G.cloneWithWhen(this.#t.node,K.WhenNode.create((0,w.parseValueBinaryOperationOrExpression)(e)))})}else(e){return new Y({...this.#t,node:G.cloneWith(this.#t.node,{else:(0,q.isSafeImmediateValue)(e)?(0,q.parseSafeImmediateValue)(e):(0,q.parseValueExpression)(e)})})}end(){return new S(G.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new S(G.cloneWith(this.#t.node,{isStatement:!0}))}}class Y{#t;constructor(e){this.#t=(0,l.freeze)(e)}end(){return new S(G.cloneWith(this.#t.node,{isStatement:!1}))}endCase(){return new S(G.cloneWith(this.#t.node,{isStatement:!0}))}}},74502,e=>{"use strict";var t=e.i(11874);let r=(0,t.freeze)({is:e=>"JSONPathLegNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"JSONPathLegNode",type:e,value:r})});e.s(["JSONPathLegNode",0,r])},95031,65133,89911,e=>{"use strict";e.s(["isExpressionOrFactory",()=>J,"parseAliasedExpression",()=>V,"parseExpression",()=>F],95031);var t=e.i(62997),r=e.i(67450);e.s(["createExpressionBuilder",()=>D,"expressionBuilder",()=>M],89911);var i=e.i(82096),s=e.i(8134),o=e.i(25466),n=e.i(86870),a=e.i(20461),d=e.i(39914),p=e.i(54256),h=e.i(67545),u=e.i(80061),l=e.i(44431),c=e.i(28008),N=e.i(89332),f=e.i(11176),m=e.i(85796),y=e.i(32150),v=e.i(58971),g=e.i(11874),w=e.i(63422),O=e.i(49216),b=e.i(58450),x=e.i(74502),W=e.i(66590),S=e.i(73043),z=e.i(89149);class C{#x;constructor(e){this.#x=e}at(e){return this.#I("ArrayLocation",e)}key(e){return this.#I("Member",e)}#I(e,t){return new I(S.JSONReferenceNode.is(this.#x)?S.JSONReferenceNode.cloneWithTraversal(this.#x,W.JSONPathNode.is(this.#x.traversal)?W.JSONPathNode.cloneWithLeg(this.#x.traversal,x.JSONPathLegNode.create(e,t)):b.JSONOperatorChainNode.cloneWithValue(this.#x.traversal,z.ValueNode.createImmediate(t))):W.JSONPathNode.cloneWithLeg(this.#x,x.JSONPathLegNode.create(e,t)))}}class I extends C{#x;constructor(e){super(e),this.#x=e}get expressionType(){}as(e){return new q(this,e)}$castTo(){return new I(this.#x)}$notNull(){return new I(this.#x)}toOperationNode(){return this.#x}}class q{#q;#S;constructor(e,t){this.#q=e,this.#S=t}get expression(){return this.#q}get alias(){return this.#S}toOperationNode(){return w.AliasNode.create(this.#q.toOperationNode(),(0,r.isOperationNodeSource)(this.#S)?this.#S.toOperationNode():O.IdentifierNode.create(this.#S))}}var k=e.i(46271),B=e.i(1695);let E=(0,g.freeze)({is:e=>"TupleNode"===e.kind,create:e=>(0,g.freeze)({kind:"TupleNode",values:(0,g.freeze)(e)})}),T=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],Q=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],R=(0,g.freeze)({is:e=>"DataTypeNode"===e.kind,create:e=>(0,g.freeze)({kind:"DataTypeNode",dataType:e})});function L(e){if((0,r.isOperationNodeSource)(e))return e.toOperationNode();if(T.includes(e)||Q.some(t=>t.test(e)))return R.create(e);throw Error(`invalid column data type ${JSON.stringify(e)}`)}e.s(["parseDataTypeExpression",()=>L],65133);let A=(0,g.freeze)({is:e=>"CastNode"===e.kind,create:(e,t)=>(0,g.freeze)({kind:"CastNode",expression:e,dataType:t})});function D(e=m.NOOP_QUERY_EXECUTOR){function t(e,t){return new l.ExpressionWrapper((0,N.parseUnaryOperation)(e,t))}let r=Object.assign(function(e,t,r){return new l.ExpressionWrapper((0,h.parseValueBinaryOperation)(e,t,r))},{fn:void 0,eb:void 0,selectFrom:t=>(0,i.createSelectQueryBuilder)({queryId:(0,a.createQueryId)(),executor:e,queryNode:s.SelectQueryNode.createFrom((0,o.parseTableExpressionOrList)(t))}),case:e=>new y.CaseBuilder({node:v.CaseNode.create((0,g.isUndefined)(e)?void 0:(0,p.parseReferenceExpression)(e))}),ref:(e,t)=>(0,g.isUndefined)(t)?new l.ExpressionWrapper((0,p.parseStringReference)(e)):new C((0,p.parseJSONReference)(e,t)),jsonPath:()=>new C(W.JSONPathNode.create()),table:e=>new l.ExpressionWrapper((0,o.parseTable)(e)),val:e=>new l.ExpressionWrapper((0,f.parseValueExpression)(e)),refTuple:(...e)=>new l.ExpressionWrapper(E.create(e.map(p.parseReferenceExpression))),tuple:(...e)=>new l.ExpressionWrapper(E.create(e.map(f.parseValueExpression))),lit:e=>new l.ExpressionWrapper((0,f.parseSafeImmediateValue)(e)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,r)=>new l.ExpressionWrapper(k.BinaryOperationNode.create((0,p.parseReferenceExpression)(e),c.OperatorNode.create("between"),B.AndNode.create((0,f.parseValueExpression)(t),(0,f.parseValueExpression)(r)))),betweenSymmetric:(e,t,r)=>new l.ExpressionWrapper(k.BinaryOperationNode.create((0,p.parseReferenceExpression)(e),c.OperatorNode.create("between symmetric"),B.AndNode.create((0,f.parseValueExpression)(t),(0,f.parseValueExpression)(r)))),and:e=>new l.ExpressionWrapper((0,g.isReadonlyArray)(e)?(0,h.parseFilterList)(e,"and"):(0,h.parseFilterObject)(e,"and")),or:e=>new l.ExpressionWrapper((0,g.isReadonlyArray)(e)?(0,h.parseFilterList)(e,"or"):(0,h.parseFilterObject)(e,"or")),parens(...e){let t=(0,h.parseValueBinaryOperationOrExpression)(e);return new l.ExpressionWrapper(u.ParensNode.is(t)?t:u.ParensNode.create(t))},cast:(e,t)=>new l.ExpressionWrapper(A.create((0,p.parseReferenceExpression)(e),L(t))),withSchema:t=>D(e.withPluginAtFront(new n.WithSchemaPlugin(t)))});return r.fn=(0,d.createFunctionModule)(),r.eb=r,r}function M(e){return D()}function F(e){if((0,r.isOperationNodeSource)(e))return e.toOperationNode();if((0,g.isFunction)(e))return e(D()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(e)}`)}function V(e){if((0,r.isOperationNodeSource)(e))return e.toOperationNode();if((0,g.isFunction)(e))return e(D()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function J(e){return(0,t.isExpression)(e)||(0,t.isAliasedExpression)(e)||(0,g.isFunction)(e)}},25466,91659,e=>{"use strict";e.s(["parseAliasedTable",()=>l,"parseTable",()=>c,"parseTableExpression",()=>u,"parseTableExpressionOrList",()=>h],25466);var t=e.i(11874),r=e.i(63422),i=e.i(14692),s=e.i(95031),o=e.i(49216);e.s(["DynamicTableBuilder",()=>a,"isAliasedDynamicTableBuilder",()=>p],91659);var n=e.i(67450);class a{#k;get table(){return this.#k}constructor(e){this.#k=e}as(e){return new d(this.#k,e)}}class d{#k;#S;get table(){return this.#k}get alias(){return this.#S}constructor(e,t){this.#k=e,this.#S=t}toOperationNode(){return r.AliasNode.create(c(this.#k),o.IdentifierNode.create(this.#S))}}function p(e){return(0,t.isObject)(e)&&(0,n.isOperationNodeSource)(e)&&(0,t.isString)(e.table)&&(0,t.isString)(e.alias)}function h(e){return(0,t.isReadonlyArray)(e)?e.map(e=>u(e)):[u(e)]}function u(e){return(0,t.isString)(e)?l(e):p(e)?e.toOperationNode():(0,s.parseAliasedExpression)(e)}function l(e){let t=" as ";if(!e.includes(t))return c(e);{let[i,s]=e.split(t).map(N);return r.AliasNode.create(c(i),o.IdentifierNode.create(s))}}function c(e){if(!e.includes("."))return i.TableNode.create(e);{let[t,r]=e.split(".").map(N);return i.TableNode.createWithSchema(t,r)}}function N(e){return e.trim()}},75780,e=>{"use strict";var t=e.i(11874),r=e.i(71145);let i=(0,t.freeze)({is:e=>"CreateViewNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateViewNode",name:r.SchemableIdentifierNode.create(e)}),cloneWith:(e,r)=>(0,t.freeze)({...e,...r})});e.s(["CreateViewNode",0,i])},90948,e=>{"use strict";class t{transformQuery(e){return e.node}async transformResult(e){return e.result}}e.s(["NoopPlugin",()=>t])},830,e=>{"use strict";e.i(90948),e.i(86870),(0,e.i(11874).freeze)({__noMigrations__:!0}),e.s(["DEFAULT_MIGRATION_LOCK_TABLE",0,"kysely_migration_lock","DEFAULT_MIGRATION_TABLE",0,"kysely_migration"])},47908,e=>{"use strict";var t=e.i(49216),r=e.i(67450),i=e.i(18766),s=e.i(89149),o=e.i(54256),n=e.i(25466),a=e.i(11176),d=e.i(20461),p=e.i(63422),h=e.i(11874),u=e.i(85796);class l{#t;constructor(e){this.#t=(0,h.freeze)(e)}get expressionType(){}get isRawBuilder(){return!0}as(e){return new N(this,e)}$castTo(){return new l({...this.#t})}$notNull(){return new l(this.#t)}withPlugin(e){return new l({...this.#t,plugins:void 0!==this.#t.plugins?(0,h.freeze)([...this.#t.plugins,e]):(0,h.freeze)([e])})}toOperationNode(){return this.#B(this.#E())}compile(e){return this.#T(this.#E(e))}async execute(e){let t=this.#E(e);return t.executeQuery(this.#T(t))}#E(e){let t=void 0!==e?e.getExecutor():u.NOOP_QUERY_EXECUTOR;return void 0!==this.#t.plugins?t.withPlugins(this.#t.plugins):t}#B(e){return e.transformQuery(this.#t.rawNode,this.#t.queryId)}#T(e){return e.compileQuery(this.#B(e),this.#t.queryId)}}function c(e){return new l(e)}class N{#Q;#S;constructor(e,t){this.#Q=e,this.#S=t}get expression(){return this.#Q}get alias(){return this.#S}get rawBuilder(){return this.#Q}toOperationNode(){return p.AliasNode.create(this.#Q.toOperationNode(),(0,r.isOperationNodeSource)(this.#S)?this.#S.toOperationNode():t.IdentifierNode.create(this.#S))}}let f=Object.assign((e,...t)=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.create(e,t?.map(m)??[])}),{ref:e=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithChild((0,o.parseStringReference)(e))}),val:e=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithChild((0,a.parseValueExpression)(e))}),value(e){return this.val(e)},table:e=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithChild((0,n.parseTable)(e))}),id(...e){let r=Array(e.length+1).fill(".");return r[0]="",r[r.length-1]="",c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.create(r,e.map(t.IdentifierNode.create))})},lit:e=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithChild(s.ValueNode.createImmediate(e))}),literal(e){return this.lit(e)},raw:e=>c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithSql(e)}),join(e,t=f`, `){let r=Array(Math.max(2*e.length-1,0)),s=t.toOperationNode();for(let t=0;t<e.length;++t)r[2*t]=m(e[t]),t!==e.length-1&&(r[2*t+1]=s);return c({queryId:(0,d.createQueryId)(),rawNode:i.RawNode.createWithChildren(r)})}});function m(e){return(0,r.isOperationNodeSource)(e)?e.toOperationNode():(0,a.parseValueExpression)(e)}e.s(["sql",0,f],47908)},63692,e=>{"use strict";var t=e.i(18766),r=e.i(11874),i=e.i(20461);let s=(0,r.freeze)({raw:(e,s=[])=>(0,r.freeze)({sql:e,query:t.RawNode.createWithSql(e),parameters:(0,r.freeze)(s),queryId:(0,i.createQueryId)()})});e.s(["CompiledQuery",0,s])},3449,e=>{"use strict";var t=e.i(11874);class r{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#R=(0,t.freeze)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#R[e.kind](e),this.nodeStack.pop()}}e.s(["OperationNodeVisitor",()=>r])},20204,e=>{"use strict";var t=e.i(24356),r=e.i(608),i=e.i(3449),s=e.i(28008),o=e.i(80061),n=e.i(18766),a=e.i(11874),d=e.i(75780),p=e.i(4038),h=e.i(44625),u=e.i(74988);let l=/'/g;class c extends i.OperationNodeVisitor{#L="";#A=[];get numParameters(){return this.#A.length}compileQuery(e,t){return this.#L="",this.#A=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(e),(0,a.freeze)({query:e,queryId:t,sql:this.getSql(),parameters:[...this.#A]})}getSql(){return this.#L}visitSelectQuery(e){let i=void 0!==this.parentNode&&!o.ParensNode.is(this.parentNode)&&!r.InsertQueryNode.is(this.parentNode)&&!t.CreateTableNode.is(this.parentNode)&&!d.CreateViewNode.is(this.parentNode)&&!p.SetOperationNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),i&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),i&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){let r=e.length-1;for(let i=0;i<=r;i++)this.visitNode(e[i]),i<r&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){let t=void 0!==this.parentNode&&!o.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode)&&!h.WhenNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&((0,u.logOnce)("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),e.orAction&&(this.append(" "),this.visitNode(e.orAction)),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.output&&(this.append(" "),this.visitNode(e.output)),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){let t=void 0!==this.parentNode&&!o.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.output&&(this.append(" "),this.visitNode(e.output)),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!(0,a.isString)(e.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");let{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(m[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){let{sqlFragments:t,parameters:r}=e;for(let e=0;e<t.length;++e)this.append(t[e]),r.length>e&&this.visitNode(r[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){e.ifNotExists&&this.append("if not exists "),this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.collation&&(this.append(" "),this.visitNode(e.collation)),e.direction&&(this.append(" "),this.visitNode(e.direction)),e.nulls&&(this.append(" nulls "),this.append(e.nulls))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){let t=void 0!==this.parentNode&&!o.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode)&&!h.WhenNode.is(this.parentNode);if(void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.output&&(this.append(" "),this.visitNode(e.output)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins){if(!e.from)throw Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(e.joins," ")}e.where&&(this.append(" "),this.visitNode(e.where)),e.returning&&(this.append(" "),this.visitNode(e.returning)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")"),this.buildDeferrable(e)}buildDeferrable(e){void 0!==e.deferrable&&(e.deferrable?this.append(" deferrable"):this.append(" not deferrable")),void 0!==e.initiallyDeferred&&(e.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")"),this.buildDeferrable(e)}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate)),this.buildDeferrable(e)}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),(0,a.isBoolean)(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.renameConstraint&&this.visitNode(e.renameConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitRenameConstraint(e){this.append("rename constraint "),this.visitNode(e.oldName),this.append(" to "),this.visitNode(e.newName)}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitRefreshMaterializedView(e){this.append("refresh materialized view "),e.concurrently&&this.append("concurrently "),this.visitNode(e.name),e.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(N[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),this.append(")"),e.withinGroup&&(this.append(" within group ("),this.visitNode(e.withinGroup),this.append(")")),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return s.OperatorNode.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){for(let t of(e.inOperator&&this.visitNode(e.inOperator),this.append("'$"),e.pathLegs))this.visitNode(t);this.append("'")}visitJSONPathLeg(e){let t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,r=e.values.length;t<r;t++)t===r-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens," ")),e.returning&&(this.append(" "),this.visitNode(e.returning)),e.output&&(this.append(" "),this.visitNode(e.output)),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitOutput(e){this.append("output "),this.compileList(e.selections)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}visitOrAction(e){this.append(e.action)}visitCollate(e){this.append("collate "),this.visitNode(e.collation)}append(e){this.#L+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){let t=this.getLeftIdentifierWrapper(),r=this.getRightIdentifierWrapper(),i="";for(let s of e)i+=s,s===t?i+=t:s===r&&(i+=r);return i}sanitizeStringLiteral(e){return e.replace(l,"''")}addParameter(e){this.#A.push(e)}appendImmediateValue(e){if((0,a.isString)(e))this.appendStringLiteral(e);else if((0,a.isNumber)(e)||(0,a.isBoolean)(e)||(0,a.isBigInt)(e))this.append(e.toString());else if((0,a.isNull)(e))this.append("null");else if((0,a.isDate)(e))this.appendImmediateValue(e.toISOString());else throw Error(`invalid immediate value ${e}`)}appendStringLiteral(e){this.append("'"),this.append(this.sanitizeStringLiteral(e)),this.append("'")}sortSelectModifiers(e){return e.sort((e,t)=>e.modifier&&t.modifier?f[e.modifier]-f[t.modifier]:1),(0,a.freeze)(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}let N=(0,a.freeze)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),f=(0,a.freeze)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),m=(0,a.freeze)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"});e.s(["DefaultQueryCompiler",()=>c])}];

//# sourceMappingURL=9e883_kysely_dist_esm_74e4b14f._.js.map